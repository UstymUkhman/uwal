var Vt=M=>{throw TypeError(M)};var At=(M,y,E)=>y.has(M)||Vt("Cannot "+E);var S=(M,y,E)=>(At(M,y,"read from private field"),E?E.call(M):y.get(M)),Q=(M,y,E)=>y.has(M)?Vt("Cannot add the same private member more than once"):y instanceof WeakSet?y.add(M):y.set(M,E),J=(M,y,E,X)=>(At(M,y,"write to private field"),X?X.call(M,E):y.set(M,E),E),et=(M,y,E)=>(At(M,y,"access private method"),E);import{a as $t,N as Rt}from"./index-B6aSTZ5l.js";var ss=`struct Shape
{
    color: vec4f,
    matrix: mat3x3f
};

@group(0) @binding(0) var<uniform> resolution: vec3f;

fn GetClipSpace(position: vec2f) -> vec2f
{
    
    let clipSpace = position / resolution.xy * 2 - 1;

    
    return clipSpace * vec2f(1, -1);
}

@group(0) @binding(1) var<uniform> shape: Shape;

fn GetVertexClipSpace(position: vec2f) -> vec4f
{
    let matrixPosition = shape.matrix * vec3f(position, 1);
    let clipSpace = GetClipSpace(matrixPosition.xy);
    return vec4f(clipSpace, 0, 1);
}

@vertex fn shapeVertex(@location(0) position: vec2f) -> @builtin(position) vec4f
{
    return GetVertexClipSpace(position);
}`;function Lt(M,y){return class extends M{constructor(...E){super(...E),y(this)}}}const Wt=Lt(Array,M=>M.fill(0));let T=1e-6;function jt(M){function y(l=0,D=0){const d=new M(2);return l!==void 0&&(d[0]=l,D!==void 0&&(d[1]=D)),d}const E=y;function X(l,D,d){const n=d??new M(2);return n[0]=l,n[1]=D,n}function R(l,D){const d=D??new M(2);return d[0]=Math.ceil(l[0]),d[1]=Math.ceil(l[1]),d}function L(l,D){const d=D??new M(2);return d[0]=Math.floor(l[0]),d[1]=Math.floor(l[1]),d}function Dn(l,D){const d=D??new M(2);return d[0]=Math.round(l[0]),d[1]=Math.round(l[1]),d}function C(l,D=0,d=1,n){const u=n??new M(2);return u[0]=Math.min(d,Math.max(D,l[0])),u[1]=Math.min(d,Math.max(D,l[1])),u}function K(l,D,d){const n=d??new M(2);return n[0]=l[0]+D[0],n[1]=l[1]+D[1],n}function dn(l,D,d,n){const u=n??new M(2);return u[0]=l[0]+D[0]*d,u[1]=l[1]+D[1]*d,u}function v(l,D){const d=l[0],n=l[1],u=D[0],c=D[1],o=Math.sqrt(d*d+n*n),s=Math.sqrt(u*u+c*c),i=o*s,h=i&&Pn(l,D)/i;return Math.acos(h)}function k(l,D,d){const n=d??new M(2);return n[0]=l[0]-D[0],n[1]=l[1]-D[1],n}const _n=k;function pn(l,D){return Math.abs(l[0]-D[0])<T&&Math.abs(l[1]-D[1])<T}function zn(l,D){return l[0]===D[0]&&l[1]===D[1]}function xn(l,D,d,n){const u=n??new M(2);return u[0]=l[0]+d*(D[0]-l[0]),u[1]=l[1]+d*(D[1]-l[1]),u}function Fn(l,D,d,n){const u=n??new M(2);return u[0]=l[0]+d[0]*(D[0]-l[0]),u[1]=l[1]+d[1]*(D[1]-l[1]),u}function Tn(l,D,d){const n=d??new M(2);return n[0]=Math.max(l[0],D[0]),n[1]=Math.max(l[1],D[1]),n}function yn(l,D,d){const n=d??new M(2);return n[0]=Math.min(l[0],D[0]),n[1]=Math.min(l[1],D[1]),n}function nn(l,D,d){const n=d??new M(2);return n[0]=l[0]*D,n[1]=l[1]*D,n}const Un=nn;function Sn(l,D,d){const n=d??new M(2);return n[0]=l[0]/D,n[1]=l[1]/D,n}function qn(l,D){const d=D??new M(2);return d[0]=1/l[0],d[1]=1/l[1],d}const Zn=qn;function Bn(l,D,d){const n=d??new M(3),u=l[0]*D[1]-l[1]*D[0];return n[0]=0,n[1]=0,n[2]=u,n}function Pn(l,D){return l[0]*D[0]+l[1]*D[1]}function b(l){const D=l[0],d=l[1];return Math.sqrt(D*D+d*d)}const Qn=b;function fn(l){const D=l[0],d=l[1];return D*D+d*d}const Rn=fn;function tn(l,D){const d=l[0]-D[0],n=l[1]-D[1];return Math.sqrt(d*d+n*n)}const Z=tn;function O(l,D){const d=l[0]-D[0],n=l[1]-D[1];return d*d+n*n}const U=O;function wn(l,D){const d=D??new M(2),n=l[0],u=l[1],c=Math.sqrt(n*n+u*u);return c>1e-5?(d[0]=n/c,d[1]=u/c):(d[0]=0,d[1]=0),d}function Ln(l,D){const d=D??new M(2);return d[0]=-l[0],d[1]=-l[1],d}function _(l,D){const d=D??new M(2);return d[0]=l[0],d[1]=l[1],d}const Wn=_;function gn(l,D,d){const n=d??new M(2);return n[0]=l[0]*D[0],n[1]=l[1]*D[1],n}const jn=gn;function An(l,D,d){const n=d??new M(2);return n[0]=l[0]/D[0],n[1]=l[1]/D[1],n}const On=An;function Yn(l=1,D){const d=D??new M(2),n=Math.random()*2*Math.PI;return d[0]=Math.cos(n)*l,d[1]=Math.sin(n)*l,d}function p(l){const D=l??new M(2);return D[0]=0,D[1]=0,D}function z(l,D,d){const n=d??new M(2),u=l[0],c=l[1];return n[0]=u*D[0]+c*D[4]+D[12],n[1]=u*D[1]+c*D[5]+D[13],n}function a(l,D,d){const n=d??new M(2),u=l[0],c=l[1];return n[0]=D[0]*u+D[4]*c+D[8],n[1]=D[1]*u+D[5]*c+D[9],n}function t(l,D,d,n){const u=n??new M(2),c=l[0]-D[0],o=l[1]-D[1],s=Math.sin(d),i=Math.cos(d);return u[0]=c*i-o*s+D[0],u[1]=c*s+o*i+D[1],u}function r(l,D,d){const n=d??new M(2);return wn(l,n),nn(n,D,n)}function e(l,D,d){const n=d??new M(2);return b(l)>D?r(l,D,n):_(l,n)}function f(l,D,d){const n=d??new M(2);return xn(l,D,.5,n)}return{create:y,fromValues:E,set:X,ceil:R,floor:L,round:Dn,clamp:C,add:K,addScaled:dn,angle:v,subtract:k,sub:_n,equalsApproximately:pn,equals:zn,lerp:xn,lerpV:Fn,max:Tn,min:yn,mulScalar:nn,scale:Un,divScalar:Sn,inverse:qn,invert:Zn,cross:Bn,dot:Pn,length:b,len:Qn,lengthSq:fn,lenSq:Rn,distance:tn,dist:Z,distanceSq:O,distSq:U,normalize:wn,negate:Ln,copy:_,clone:Wn,multiply:gn,mul:jn,divide:An,div:On,random:Yn,zero:p,transformMat4:z,transformMat3:a,rotate:t,setLength:r,truncate:e,midpoint:f}}const Et=new Map;function Gt(M){let y=Et.get(M);return y||(y=jt(M),Et.set(M,y)),y}function Ht(M){function y(s,i,h){const w=new M(3);return s!==void 0&&(w[0]=s,i!==void 0&&(w[1]=i,h!==void 0&&(w[2]=h))),w}const E=y;function X(s,i,h,w){const x=w??new M(3);return x[0]=s,x[1]=i,x[2]=h,x}function R(s,i){const h=i??new M(3);return h[0]=Math.ceil(s[0]),h[1]=Math.ceil(s[1]),h[2]=Math.ceil(s[2]),h}function L(s,i){const h=i??new M(3);return h[0]=Math.floor(s[0]),h[1]=Math.floor(s[1]),h[2]=Math.floor(s[2]),h}function Dn(s,i){const h=i??new M(3);return h[0]=Math.round(s[0]),h[1]=Math.round(s[1]),h[2]=Math.round(s[2]),h}function C(s,i=0,h=1,w){const x=w??new M(3);return x[0]=Math.min(h,Math.max(i,s[0])),x[1]=Math.min(h,Math.max(i,s[1])),x[2]=Math.min(h,Math.max(i,s[2])),x}function K(s,i,h){const w=h??new M(3);return w[0]=s[0]+i[0],w[1]=s[1]+i[1],w[2]=s[2]+i[2],w}function dn(s,i,h,w){const x=w??new M(3);return x[0]=s[0]+i[0]*h,x[1]=s[1]+i[1]*h,x[2]=s[2]+i[2]*h,x}function v(s,i){const h=s[0],w=s[1],x=s[2],g=i[0],A=i[1],P=i[2],q=Math.sqrt(h*h+w*w+x*x),B=Math.sqrt(g*g+A*A+P*P),I=q*B,F=I&&Pn(s,i)/I;return Math.acos(F)}function k(s,i,h){const w=h??new M(3);return w[0]=s[0]-i[0],w[1]=s[1]-i[1],w[2]=s[2]-i[2],w}const _n=k;function pn(s,i){return Math.abs(s[0]-i[0])<T&&Math.abs(s[1]-i[1])<T&&Math.abs(s[2]-i[2])<T}function zn(s,i){return s[0]===i[0]&&s[1]===i[1]&&s[2]===i[2]}function xn(s,i,h,w){const x=w??new M(3);return x[0]=s[0]+h*(i[0]-s[0]),x[1]=s[1]+h*(i[1]-s[1]),x[2]=s[2]+h*(i[2]-s[2]),x}function Fn(s,i,h,w){const x=w??new M(3);return x[0]=s[0]+h[0]*(i[0]-s[0]),x[1]=s[1]+h[1]*(i[1]-s[1]),x[2]=s[2]+h[2]*(i[2]-s[2]),x}function Tn(s,i,h){const w=h??new M(3);return w[0]=Math.max(s[0],i[0]),w[1]=Math.max(s[1],i[1]),w[2]=Math.max(s[2],i[2]),w}function yn(s,i,h){const w=h??new M(3);return w[0]=Math.min(s[0],i[0]),w[1]=Math.min(s[1],i[1]),w[2]=Math.min(s[2],i[2]),w}function nn(s,i,h){const w=h??new M(3);return w[0]=s[0]*i,w[1]=s[1]*i,w[2]=s[2]*i,w}const Un=nn;function Sn(s,i,h){const w=h??new M(3);return w[0]=s[0]/i,w[1]=s[1]/i,w[2]=s[2]/i,w}function qn(s,i){const h=i??new M(3);return h[0]=1/s[0],h[1]=1/s[1],h[2]=1/s[2],h}const Zn=qn;function Bn(s,i,h){const w=h??new M(3),x=s[2]*i[0]-s[0]*i[2],g=s[0]*i[1]-s[1]*i[0];return w[0]=s[1]*i[2]-s[2]*i[1],w[1]=x,w[2]=g,w}function Pn(s,i){return s[0]*i[0]+s[1]*i[1]+s[2]*i[2]}function b(s){const i=s[0],h=s[1],w=s[2];return Math.sqrt(i*i+h*h+w*w)}const Qn=b;function fn(s){const i=s[0],h=s[1],w=s[2];return i*i+h*h+w*w}const Rn=fn;function tn(s,i){const h=s[0]-i[0],w=s[1]-i[1],x=s[2]-i[2];return Math.sqrt(h*h+w*w+x*x)}const Z=tn;function O(s,i){const h=s[0]-i[0],w=s[1]-i[1],x=s[2]-i[2];return h*h+w*w+x*x}const U=O;function wn(s,i){const h=i??new M(3),w=s[0],x=s[1],g=s[2],A=Math.sqrt(w*w+x*x+g*g);return A>1e-5?(h[0]=w/A,h[1]=x/A,h[2]=g/A):(h[0]=0,h[1]=0,h[2]=0),h}function Ln(s,i){const h=i??new M(3);return h[0]=-s[0],h[1]=-s[1],h[2]=-s[2],h}function _(s,i){const h=i??new M(3);return h[0]=s[0],h[1]=s[1],h[2]=s[2],h}const Wn=_;function gn(s,i,h){const w=h??new M(3);return w[0]=s[0]*i[0],w[1]=s[1]*i[1],w[2]=s[2]*i[2],w}const jn=gn;function An(s,i,h){const w=h??new M(3);return w[0]=s[0]/i[0],w[1]=s[1]/i[1],w[2]=s[2]/i[2],w}const On=An;function Yn(s=1,i){const h=i??new M(3),w=Math.random()*2*Math.PI,x=Math.random()*2-1,g=Math.sqrt(1-x*x)*s;return h[0]=Math.cos(w)*g,h[1]=Math.sin(w)*g,h[2]=x*s,h}function p(s){const i=s??new M(3);return i[0]=0,i[1]=0,i[2]=0,i}function z(s,i,h){const w=h??new M(3),x=s[0],g=s[1],A=s[2],P=i[3]*x+i[7]*g+i[11]*A+i[15]||1;return w[0]=(i[0]*x+i[4]*g+i[8]*A+i[12])/P,w[1]=(i[1]*x+i[5]*g+i[9]*A+i[13])/P,w[2]=(i[2]*x+i[6]*g+i[10]*A+i[14])/P,w}function a(s,i,h){const w=h??new M(3),x=s[0],g=s[1],A=s[2];return w[0]=x*i[0*4+0]+g*i[1*4+0]+A*i[2*4+0],w[1]=x*i[0*4+1]+g*i[1*4+1]+A*i[2*4+1],w[2]=x*i[0*4+2]+g*i[1*4+2]+A*i[2*4+2],w}function t(s,i,h){const w=h??new M(3),x=s[0],g=s[1],A=s[2];return w[0]=x*i[0]+g*i[4]+A*i[8],w[1]=x*i[1]+g*i[5]+A*i[9],w[2]=x*i[2]+g*i[6]+A*i[10],w}function r(s,i,h){const w=h??new M(3),x=i[0],g=i[1],A=i[2],P=i[3]*2,q=s[0],B=s[1],I=s[2],F=g*I-A*B,V=A*q-x*I,$=x*B-g*q;return w[0]=q+F*P+(g*$-A*V)*2,w[1]=B+V*P+(A*F-x*$)*2,w[2]=I+$*P+(x*V-g*F)*2,w}function e(s,i){const h=i??new M(3);return h[0]=s[12],h[1]=s[13],h[2]=s[14],h}function f(s,i,h){const w=h??new M(3),x=i*4;return w[0]=s[x+0],w[1]=s[x+1],w[2]=s[x+2],w}function l(s,i){const h=i??new M(3),w=s[0],x=s[1],g=s[2],A=s[4],P=s[5],q=s[6],B=s[8],I=s[9],F=s[10];return h[0]=Math.sqrt(w*w+x*x+g*g),h[1]=Math.sqrt(A*A+P*P+q*q),h[2]=Math.sqrt(B*B+I*I+F*F),h}function D(s,i,h,w){const x=w??new M(3),g=[],A=[];return g[0]=s[0]-i[0],g[1]=s[1]-i[1],g[2]=s[2]-i[2],A[0]=g[0],A[1]=g[1]*Math.cos(h)-g[2]*Math.sin(h),A[2]=g[1]*Math.sin(h)+g[2]*Math.cos(h),x[0]=A[0]+i[0],x[1]=A[1]+i[1],x[2]=A[2]+i[2],x}function d(s,i,h,w){const x=w??new M(3),g=[],A=[];return g[0]=s[0]-i[0],g[1]=s[1]-i[1],g[2]=s[2]-i[2],A[0]=g[2]*Math.sin(h)+g[0]*Math.cos(h),A[1]=g[1],A[2]=g[2]*Math.cos(h)-g[0]*Math.sin(h),x[0]=A[0]+i[0],x[1]=A[1]+i[1],x[2]=A[2]+i[2],x}function n(s,i,h,w){const x=w??new M(3),g=[],A=[];return g[0]=s[0]-i[0],g[1]=s[1]-i[1],g[2]=s[2]-i[2],A[0]=g[0]*Math.cos(h)-g[1]*Math.sin(h),A[1]=g[0]*Math.sin(h)+g[1]*Math.cos(h),A[2]=g[2],x[0]=A[0]+i[0],x[1]=A[1]+i[1],x[2]=A[2]+i[2],x}function u(s,i,h){const w=h??new M(3);return wn(s,w),nn(w,i,w)}function c(s,i,h){const w=h??new M(3);return b(s)>i?u(s,i,w):_(s,w)}function o(s,i,h){const w=h??new M(3);return xn(s,i,.5,w)}return{create:y,fromValues:E,set:X,ceil:R,floor:L,round:Dn,clamp:C,add:K,addScaled:dn,angle:v,subtract:k,sub:_n,equalsApproximately:pn,equals:zn,lerp:xn,lerpV:Fn,max:Tn,min:yn,mulScalar:nn,scale:Un,divScalar:Sn,inverse:qn,invert:Zn,cross:Bn,dot:Pn,length:b,len:Qn,lengthSq:fn,lenSq:Rn,distance:tn,dist:Z,distanceSq:O,distSq:U,normalize:wn,negate:Ln,copy:_,clone:Wn,multiply:gn,mul:jn,divide:An,div:On,random:Yn,zero:p,transformMat4:z,transformMat4Upper3x3:a,transformMat3:t,transformQuat:r,getTranslation:e,getAxis:f,getScaling:l,rotateX:D,rotateY:d,rotateZ:n,setLength:u,truncate:c,midpoint:o}}const Ft=new Map;function gt(M){let y=Ft.get(M);return y||(y=Ht(M),Ft.set(M,y)),y}function Nt(M){const y=Gt(M),E=gt(M);function X(t,r,e,f,l,D,d,n,u){const c=new M(12);return c[3]=0,c[7]=0,c[11]=0,t!==void 0&&(c[0]=t,r!==void 0&&(c[1]=r,e!==void 0&&(c[2]=e,f!==void 0&&(c[4]=f,l!==void 0&&(c[5]=l,D!==void 0&&(c[6]=D,d!==void 0&&(c[8]=d,n!==void 0&&(c[9]=n,u!==void 0&&(c[10]=u))))))))),c}function R(t,r,e,f,l,D,d,n,u,c){const o=c??new M(12);return o[0]=t,o[1]=r,o[2]=e,o[3]=0,o[4]=f,o[5]=l,o[6]=D,o[7]=0,o[8]=d,o[9]=n,o[10]=u,o[11]=0,o}function L(t,r){const e=r??new M(12);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=0,e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=0,e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=0,e}function Dn(t,r){const e=r??new M(12),f=t[0],l=t[1],D=t[2],d=t[3],n=f+f,u=l+l,c=D+D,o=f*n,s=l*n,i=l*u,h=D*n,w=D*u,x=D*c,g=d*n,A=d*u,P=d*c;return e[0]=1-i-x,e[1]=s+P,e[2]=h-A,e[3]=0,e[4]=s-P,e[5]=1-o-x,e[6]=w+g,e[7]=0,e[8]=h+A,e[9]=w-g,e[10]=1-o-i,e[11]=0,e}function C(t,r){const e=r??new M(12);return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[4]=-t[4],e[5]=-t[5],e[6]=-t[6],e[8]=-t[8],e[9]=-t[9],e[10]=-t[10],e}function K(t,r,e){const f=e??new M(12);return f[0]=t[0]*r,f[1]=t[1]*r,f[2]=t[2]*r,f[4]=t[4]*r,f[5]=t[5]*r,f[6]=t[6]*r,f[8]=t[8]*r,f[9]=t[9]*r,f[10]=t[10]*r,f}const dn=K;function v(t,r,e){const f=e??new M(12);return f[0]=t[0]+r[0],f[1]=t[1]+r[1],f[2]=t[2]+r[2],f[4]=t[4]+r[4],f[5]=t[5]+r[5],f[6]=t[6]+r[6],f[8]=t[8]+r[8],f[9]=t[9]+r[9],f[10]=t[10]+r[10],f}function k(t,r){const e=r??new M(12);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[8]=t[8],e[9]=t[9],e[10]=t[10],e}const _n=k;function pn(t,r){return Math.abs(t[0]-r[0])<T&&Math.abs(t[1]-r[1])<T&&Math.abs(t[2]-r[2])<T&&Math.abs(t[4]-r[4])<T&&Math.abs(t[5]-r[5])<T&&Math.abs(t[6]-r[6])<T&&Math.abs(t[8]-r[8])<T&&Math.abs(t[9]-r[9])<T&&Math.abs(t[10]-r[10])<T}function zn(t,r){return t[0]===r[0]&&t[1]===r[1]&&t[2]===r[2]&&t[4]===r[4]&&t[5]===r[5]&&t[6]===r[6]&&t[8]===r[8]&&t[9]===r[9]&&t[10]===r[10]}function xn(t){const r=t??new M(12);return r[0]=1,r[1]=0,r[2]=0,r[4]=0,r[5]=1,r[6]=0,r[8]=0,r[9]=0,r[10]=1,r}function Fn(t,r){const e=r??new M(12);if(e===t){let i;return i=t[1],t[1]=t[4],t[4]=i,i=t[2],t[2]=t[8],t[8]=i,i=t[6],t[6]=t[9],t[9]=i,e}const f=t[0*4+0],l=t[0*4+1],D=t[0*4+2],d=t[1*4+0],n=t[1*4+1],u=t[1*4+2],c=t[2*4+0],o=t[2*4+1],s=t[2*4+2];return e[0]=f,e[1]=d,e[2]=c,e[4]=l,e[5]=n,e[6]=o,e[8]=D,e[9]=u,e[10]=s,e}function Tn(t,r){const e=r??new M(12),f=t[0*4+0],l=t[0*4+1],D=t[0*4+2],d=t[1*4+0],n=t[1*4+1],u=t[1*4+2],c=t[2*4+0],o=t[2*4+1],s=t[2*4+2],i=s*n-u*o,h=-s*d+u*c,w=o*d-n*c,x=1/(f*i+l*h+D*w);return e[0]=i*x,e[1]=(-s*l+D*o)*x,e[2]=(u*l-D*n)*x,e[4]=h*x,e[5]=(s*f-D*c)*x,e[6]=(-u*f+D*d)*x,e[8]=w*x,e[9]=(-o*f+l*c)*x,e[10]=(n*f-l*d)*x,e}function yn(t){const r=t[0],e=t[0*4+1],f=t[0*4+2],l=t[1*4+0],D=t[1*4+1],d=t[1*4+2],n=t[2*4+0],u=t[2*4+1],c=t[2*4+2];return r*(D*c-u*d)-l*(e*c-u*f)+n*(e*d-D*f)}const nn=Tn;function Un(t,r,e){const f=e??new M(12),l=t[0],D=t[1],d=t[2],n=t[4],u=t[5],c=t[6],o=t[8],s=t[9],i=t[10],h=r[0],w=r[1],x=r[2],g=r[4],A=r[5],P=r[6],q=r[8],B=r[9],I=r[10];return f[0]=l*h+n*w+o*x,f[1]=D*h+u*w+s*x,f[2]=d*h+c*w+i*x,f[4]=l*g+n*A+o*P,f[5]=D*g+u*A+s*P,f[6]=d*g+c*A+i*P,f[8]=l*q+n*B+o*I,f[9]=D*q+u*B+s*I,f[10]=d*q+c*B+i*I,f}const Sn=Un;function qn(t,r,e){const f=e??xn();return t!==f&&(f[0]=t[0],f[1]=t[1],f[2]=t[2],f[4]=t[4],f[5]=t[5],f[6]=t[6]),f[8]=r[0],f[9]=r[1],f[10]=1,f}function Zn(t,r){const e=r??y.create();return e[0]=t[8],e[1]=t[9],e}function Bn(t,r,e){const f=e??y.create(),l=r*4;return f[0]=t[l+0],f[1]=t[l+1],f}function Pn(t,r,e,f){const l=f===t?t:k(t,f),D=e*4;return l[D+0]=r[0],l[D+1]=r[1],l}function b(t,r){const e=r??y.create(),f=t[0],l=t[1],D=t[4],d=t[5];return e[0]=Math.sqrt(f*f+l*l),e[1]=Math.sqrt(D*D+d*d),e}function Qn(t,r){const e=r??E.create(),f=t[0],l=t[1],D=t[2],d=t[4],n=t[5],u=t[6],c=t[8],o=t[9],s=t[10];return e[0]=Math.sqrt(f*f+l*l+D*D),e[1]=Math.sqrt(d*d+n*n+u*u),e[2]=Math.sqrt(c*c+o*o+s*s),e}function fn(t,r){const e=r??new M(12);return e[0]=1,e[1]=0,e[2]=0,e[4]=0,e[5]=1,e[6]=0,e[8]=t[0],e[9]=t[1],e[10]=1,e}function Rn(t,r,e){const f=e??new M(12),l=r[0],D=r[1],d=t[0],n=t[1],u=t[2],c=t[1*4+0],o=t[1*4+1],s=t[1*4+2],i=t[2*4+0],h=t[2*4+1],w=t[2*4+2];return t!==f&&(f[0]=d,f[1]=n,f[2]=u,f[4]=c,f[5]=o,f[6]=s),f[8]=d*l+c*D+i,f[9]=n*l+o*D+h,f[10]=u*l+s*D+w,f}function tn(t,r){const e=r??new M(12),f=Math.cos(t),l=Math.sin(t);return e[0]=f,e[1]=l,e[2]=0,e[4]=-l,e[5]=f,e[6]=0,e[8]=0,e[9]=0,e[10]=1,e}function Z(t,r,e){const f=e??new M(12),l=t[0*4+0],D=t[0*4+1],d=t[0*4+2],n=t[1*4+0],u=t[1*4+1],c=t[1*4+2],o=Math.cos(r),s=Math.sin(r);return f[0]=o*l+s*n,f[1]=o*D+s*u,f[2]=o*d+s*c,f[4]=o*n-s*l,f[5]=o*u-s*D,f[6]=o*c-s*d,t!==f&&(f[8]=t[8],f[9]=t[9],f[10]=t[10]),f}function O(t,r){const e=r??new M(12),f=Math.cos(t),l=Math.sin(t);return e[0]=1,e[1]=0,e[2]=0,e[4]=0,e[5]=f,e[6]=l,e[8]=0,e[9]=-l,e[10]=f,e}function U(t,r,e){const f=e??new M(12),l=t[4],D=t[5],d=t[6],n=t[8],u=t[9],c=t[10],o=Math.cos(r),s=Math.sin(r);return f[4]=o*l+s*n,f[5]=o*D+s*u,f[6]=o*d+s*c,f[8]=o*n-s*l,f[9]=o*u-s*D,f[10]=o*c-s*d,t!==f&&(f[0]=t[0],f[1]=t[1],f[2]=t[2]),f}function wn(t,r){const e=r??new M(12),f=Math.cos(t),l=Math.sin(t);return e[0]=f,e[1]=0,e[2]=-l,e[4]=0,e[5]=1,e[6]=0,e[8]=l,e[9]=0,e[10]=f,e}function Ln(t,r,e){const f=e??new M(12),l=t[0*4+0],D=t[0*4+1],d=t[0*4+2],n=t[2*4+0],u=t[2*4+1],c=t[2*4+2],o=Math.cos(r),s=Math.sin(r);return f[0]=o*l-s*n,f[1]=o*D-s*u,f[2]=o*d-s*c,f[8]=o*n+s*l,f[9]=o*u+s*D,f[10]=o*c+s*d,t!==f&&(f[4]=t[4],f[5]=t[5],f[6]=t[6]),f}const _=tn,Wn=Z;function gn(t,r){const e=r??new M(12);return e[0]=t[0],e[1]=0,e[2]=0,e[4]=0,e[5]=t[1],e[6]=0,e[8]=0,e[9]=0,e[10]=1,e}function jn(t,r,e){const f=e??new M(12),l=r[0],D=r[1];return f[0]=l*t[0*4+0],f[1]=l*t[0*4+1],f[2]=l*t[0*4+2],f[4]=D*t[1*4+0],f[5]=D*t[1*4+1],f[6]=D*t[1*4+2],t!==f&&(f[8]=t[8],f[9]=t[9],f[10]=t[10]),f}function An(t,r){const e=r??new M(12);return e[0]=t[0],e[1]=0,e[2]=0,e[4]=0,e[5]=t[1],e[6]=0,e[8]=0,e[9]=0,e[10]=t[2],e}function On(t,r,e){const f=e??new M(12),l=r[0],D=r[1],d=r[2];return f[0]=l*t[0*4+0],f[1]=l*t[0*4+1],f[2]=l*t[0*4+2],f[4]=D*t[1*4+0],f[5]=D*t[1*4+1],f[6]=D*t[1*4+2],f[8]=d*t[2*4+0],f[9]=d*t[2*4+1],f[10]=d*t[2*4+2],f}function Yn(t,r){const e=r??new M(12);return e[0]=t,e[1]=0,e[2]=0,e[4]=0,e[5]=t,e[6]=0,e[8]=0,e[9]=0,e[10]=1,e}function p(t,r,e){const f=e??new M(12);return f[0]=r*t[0*4+0],f[1]=r*t[0*4+1],f[2]=r*t[0*4+2],f[4]=r*t[1*4+0],f[5]=r*t[1*4+1],f[6]=r*t[1*4+2],t!==f&&(f[8]=t[8],f[9]=t[9],f[10]=t[10]),f}function z(t,r){const e=r??new M(12);return e[0]=t,e[1]=0,e[2]=0,e[4]=0,e[5]=t,e[6]=0,e[8]=0,e[9]=0,e[10]=t,e}function a(t,r,e){const f=e??new M(12);return f[0]=r*t[0*4+0],f[1]=r*t[0*4+1],f[2]=r*t[0*4+2],f[4]=r*t[1*4+0],f[5]=r*t[1*4+1],f[6]=r*t[1*4+2],f[8]=r*t[2*4+0],f[9]=r*t[2*4+1],f[10]=r*t[2*4+2],f}return{add:v,clone:_n,copy:k,create:X,determinant:yn,equals:zn,equalsApproximately:pn,fromMat4:L,fromQuat:Dn,get3DScaling:Qn,getAxis:Bn,getScaling:b,getTranslation:Zn,identity:xn,inverse:Tn,invert:nn,mul:Sn,mulScalar:dn,multiply:Un,multiplyScalar:K,negate:C,rotate:Z,rotateX:U,rotateY:Ln,rotateZ:Wn,rotation:tn,rotationX:O,rotationY:wn,rotationZ:_,scale:jn,scale3D:On,scaling:gn,scaling3D:An,set:R,setAxis:Pn,setTranslation:qn,translate:Rn,translation:fn,transpose:Fn,uniformScale:p,uniformScale3D:a,uniformScaling:Yn,uniformScaling3D:z}}const Tt=new Map;function Jt(M){let y=Tt.get(M);return y||(y=Nt(M),Tt.set(M,y)),y}function Kt(M){const y=gt(M);function E(n,u,c,o,s,i,h,w,x,g,A,P,q,B,I,F){const V=new M(16);return n!==void 0&&(V[0]=n,u!==void 0&&(V[1]=u,c!==void 0&&(V[2]=c,o!==void 0&&(V[3]=o,s!==void 0&&(V[4]=s,i!==void 0&&(V[5]=i,h!==void 0&&(V[6]=h,w!==void 0&&(V[7]=w,x!==void 0&&(V[8]=x,g!==void 0&&(V[9]=g,A!==void 0&&(V[10]=A,P!==void 0&&(V[11]=P,q!==void 0&&(V[12]=q,B!==void 0&&(V[13]=B,I!==void 0&&(V[14]=I,F!==void 0&&(V[15]=F)))))))))))))))),V}function X(n,u,c,o,s,i,h,w,x,g,A,P,q,B,I,F,V){const $=V??new M(16);return $[0]=n,$[1]=u,$[2]=c,$[3]=o,$[4]=s,$[5]=i,$[6]=h,$[7]=w,$[8]=x,$[9]=g,$[10]=A,$[11]=P,$[12]=q,$[13]=B,$[14]=I,$[15]=F,$}function R(n,u){const c=u??new M(16);return c[0]=n[0],c[1]=n[1],c[2]=n[2],c[3]=0,c[4]=n[4],c[5]=n[5],c[6]=n[6],c[7]=0,c[8]=n[8],c[9]=n[9],c[10]=n[10],c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}function L(n,u){const c=u??new M(16),o=n[0],s=n[1],i=n[2],h=n[3],w=o+o,x=s+s,g=i+i,A=o*w,P=s*w,q=s*x,B=i*w,I=i*x,F=i*g,V=h*w,$=h*x,G=h*g;return c[0]=1-q-F,c[1]=P+G,c[2]=B-$,c[3]=0,c[4]=P-G,c[5]=1-A-F,c[6]=I+V,c[7]=0,c[8]=B+$,c[9]=I-V,c[10]=1-A-q,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}function Dn(n,u){const c=u??new M(16);return c[0]=-n[0],c[1]=-n[1],c[2]=-n[2],c[3]=-n[3],c[4]=-n[4],c[5]=-n[5],c[6]=-n[6],c[7]=-n[7],c[8]=-n[8],c[9]=-n[9],c[10]=-n[10],c[11]=-n[11],c[12]=-n[12],c[13]=-n[13],c[14]=-n[14],c[15]=-n[15],c}function C(n,u,c){const o=c??new M(16);return o[0]=n[0]+u[0],o[1]=n[1]+u[1],o[2]=n[2]+u[2],o[3]=n[3]+u[3],o[4]=n[4]+u[4],o[5]=n[5]+u[5],o[6]=n[6]+u[6],o[7]=n[7]+u[7],o[8]=n[8]+u[8],o[9]=n[9]+u[9],o[10]=n[10]+u[10],o[11]=n[11]+u[11],o[12]=n[12]+u[12],o[13]=n[13]+u[13],o[14]=n[14]+u[14],o[15]=n[15]+u[15],o}function K(n,u,c){const o=c??new M(16);return o[0]=n[0]*u,o[1]=n[1]*u,o[2]=n[2]*u,o[3]=n[3]*u,o[4]=n[4]*u,o[5]=n[5]*u,o[6]=n[6]*u,o[7]=n[7]*u,o[8]=n[8]*u,o[9]=n[9]*u,o[10]=n[10]*u,o[11]=n[11]*u,o[12]=n[12]*u,o[13]=n[13]*u,o[14]=n[14]*u,o[15]=n[15]*u,o}const dn=K;function v(n,u){const c=u??new M(16);return c[0]=n[0],c[1]=n[1],c[2]=n[2],c[3]=n[3],c[4]=n[4],c[5]=n[5],c[6]=n[6],c[7]=n[7],c[8]=n[8],c[9]=n[9],c[10]=n[10],c[11]=n[11],c[12]=n[12],c[13]=n[13],c[14]=n[14],c[15]=n[15],c}const k=v;function _n(n,u){return Math.abs(n[0]-u[0])<T&&Math.abs(n[1]-u[1])<T&&Math.abs(n[2]-u[2])<T&&Math.abs(n[3]-u[3])<T&&Math.abs(n[4]-u[4])<T&&Math.abs(n[5]-u[5])<T&&Math.abs(n[6]-u[6])<T&&Math.abs(n[7]-u[7])<T&&Math.abs(n[8]-u[8])<T&&Math.abs(n[9]-u[9])<T&&Math.abs(n[10]-u[10])<T&&Math.abs(n[11]-u[11])<T&&Math.abs(n[12]-u[12])<T&&Math.abs(n[13]-u[13])<T&&Math.abs(n[14]-u[14])<T&&Math.abs(n[15]-u[15])<T}function pn(n,u){return n[0]===u[0]&&n[1]===u[1]&&n[2]===u[2]&&n[3]===u[3]&&n[4]===u[4]&&n[5]===u[5]&&n[6]===u[6]&&n[7]===u[7]&&n[8]===u[8]&&n[9]===u[9]&&n[10]===u[10]&&n[11]===u[11]&&n[12]===u[12]&&n[13]===u[13]&&n[14]===u[14]&&n[15]===u[15]}function zn(n){const u=n??new M(16);return u[0]=1,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=1,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=1,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u}function xn(n,u){const c=u??new M(16);if(c===n){let Y;return Y=n[1],n[1]=n[4],n[4]=Y,Y=n[2],n[2]=n[8],n[8]=Y,Y=n[3],n[3]=n[12],n[12]=Y,Y=n[6],n[6]=n[9],n[9]=Y,Y=n[7],n[7]=n[13],n[13]=Y,Y=n[11],n[11]=n[14],n[14]=Y,c}const o=n[0*4+0],s=n[0*4+1],i=n[0*4+2],h=n[0*4+3],w=n[1*4+0],x=n[1*4+1],g=n[1*4+2],A=n[1*4+3],P=n[2*4+0],q=n[2*4+1],B=n[2*4+2],I=n[2*4+3],F=n[3*4+0],V=n[3*4+1],$=n[3*4+2],G=n[3*4+3];return c[0]=o,c[1]=w,c[2]=P,c[3]=F,c[4]=s,c[5]=x,c[6]=q,c[7]=V,c[8]=i,c[9]=g,c[10]=B,c[11]=$,c[12]=h,c[13]=A,c[14]=I,c[15]=G,c}function Fn(n,u){const c=u??new M(16),o=n[0*4+0],s=n[0*4+1],i=n[0*4+2],h=n[0*4+3],w=n[1*4+0],x=n[1*4+1],g=n[1*4+2],A=n[1*4+3],P=n[2*4+0],q=n[2*4+1],B=n[2*4+2],I=n[2*4+3],F=n[3*4+0],V=n[3*4+1],$=n[3*4+2],G=n[3*4+3],Y=B*G,j=$*I,H=g*G,N=$*A,m=g*I,sn=B*A,cn=i*G,en=$*h,on=i*I,rn=B*h,an=i*A,hn=g*h,ln=P*V,Mn=F*q,In=w*V,Vn=F*x,$n=w*q,lt=P*x,Mt=o*V,Dt=F*s,dt=o*q,pt=P*s,xt=o*x,yt=w*s,qt=Y*x+N*q+m*V-(j*x+H*q+sn*V),Bt=j*s+cn*q+rn*V-(Y*s+en*q+on*V),Pt=H*s+en*x+an*V-(N*s+cn*x+hn*V),It=sn*s+on*x+hn*q-(m*s+rn*x+an*q),un=1/(o*qt+w*Bt+P*Pt+F*It);return c[0]=un*qt,c[1]=un*Bt,c[2]=un*Pt,c[3]=un*It,c[4]=un*(j*w+H*P+sn*F-(Y*w+N*P+m*F)),c[5]=un*(Y*o+en*P+on*F-(j*o+cn*P+rn*F)),c[6]=un*(N*o+cn*w+hn*F-(H*o+en*w+an*F)),c[7]=un*(m*o+rn*w+an*P-(sn*o+on*w+hn*P)),c[8]=un*(ln*A+Vn*I+$n*G-(Mn*A+In*I+lt*G)),c[9]=un*(Mn*h+Mt*I+pt*G-(ln*h+Dt*I+dt*G)),c[10]=un*(In*h+Dt*A+xt*G-(Vn*h+Mt*A+yt*G)),c[11]=un*(lt*h+dt*A+yt*I-($n*h+pt*A+xt*I)),c[12]=un*(In*B+lt*$+Mn*g-($n*$+ln*g+Vn*B)),c[13]=un*(dt*$+ln*i+Dt*B-(Mt*B+pt*$+Mn*i)),c[14]=un*(Mt*g+yt*$+Vn*i-(xt*$+In*i+Dt*g)),c[15]=un*(xt*B+$n*i+pt*g-(dt*g+yt*B+lt*i)),c}function Tn(n){const u=n[0],c=n[0*4+1],o=n[0*4+2],s=n[0*4+3],i=n[1*4+0],h=n[1*4+1],w=n[1*4+2],x=n[1*4+3],g=n[2*4+0],A=n[2*4+1],P=n[2*4+2],q=n[2*4+3],B=n[3*4+0],I=n[3*4+1],F=n[3*4+2],V=n[3*4+3],$=P*V,G=F*q,Y=w*V,j=F*x,H=w*q,N=P*x,m=o*V,sn=F*s,cn=o*q,en=P*s,on=o*x,rn=w*s,an=$*h+j*A+H*I-(G*h+Y*A+N*I),hn=G*c+m*A+en*I-($*c+sn*A+cn*I),ln=Y*c+sn*h+on*I-(j*c+m*h+rn*I),Mn=N*c+cn*h+rn*A-(H*c+en*h+on*A);return u*an+i*hn+g*ln+B*Mn}const yn=Fn;function nn(n,u,c){const o=c??new M(16),s=n[0],i=n[1],h=n[2],w=n[3],x=n[4],g=n[5],A=n[6],P=n[7],q=n[8],B=n[9],I=n[10],F=n[11],V=n[12],$=n[13],G=n[14],Y=n[15],j=u[0],H=u[1],N=u[2],m=u[3],sn=u[4],cn=u[5],en=u[6],on=u[7],rn=u[8],an=u[9],hn=u[10],ln=u[11],Mn=u[12],In=u[13],Vn=u[14],$n=u[15];return o[0]=s*j+x*H+q*N+V*m,o[1]=i*j+g*H+B*N+$*m,o[2]=h*j+A*H+I*N+G*m,o[3]=w*j+P*H+F*N+Y*m,o[4]=s*sn+x*cn+q*en+V*on,o[5]=i*sn+g*cn+B*en+$*on,o[6]=h*sn+A*cn+I*en+G*on,o[7]=w*sn+P*cn+F*en+Y*on,o[8]=s*rn+x*an+q*hn+V*ln,o[9]=i*rn+g*an+B*hn+$*ln,o[10]=h*rn+A*an+I*hn+G*ln,o[11]=w*rn+P*an+F*hn+Y*ln,o[12]=s*Mn+x*In+q*Vn+V*$n,o[13]=i*Mn+g*In+B*Vn+$*$n,o[14]=h*Mn+A*In+I*Vn+G*$n,o[15]=w*Mn+P*In+F*Vn+Y*$n,o}const Un=nn;function Sn(n,u,c){const o=c??zn();return n!==o&&(o[0]=n[0],o[1]=n[1],o[2]=n[2],o[3]=n[3],o[4]=n[4],o[5]=n[5],o[6]=n[6],o[7]=n[7],o[8]=n[8],o[9]=n[9],o[10]=n[10],o[11]=n[11]),o[12]=u[0],o[13]=u[1],o[14]=u[2],o[15]=1,o}function qn(n,u){const c=u??y.create();return c[0]=n[12],c[1]=n[13],c[2]=n[14],c}function Zn(n,u,c){const o=c??y.create(),s=u*4;return o[0]=n[s+0],o[1]=n[s+1],o[2]=n[s+2],o}function Bn(n,u,c,o){const s=o===n?o:v(n,o),i=c*4;return s[i+0]=u[0],s[i+1]=u[1],s[i+2]=u[2],s}function Pn(n,u){const c=u??y.create(),o=n[0],s=n[1],i=n[2],h=n[4],w=n[5],x=n[6],g=n[8],A=n[9],P=n[10];return c[0]=Math.sqrt(o*o+s*s+i*i),c[1]=Math.sqrt(h*h+w*w+x*x),c[2]=Math.sqrt(g*g+A*A+P*P),c}function b(n,u,c,o,s){const i=s??new M(16),h=Math.tan(Math.PI*.5-.5*n);if(i[0]=h/u,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=h,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=-1,i[12]=0,i[13]=0,i[15]=0,Number.isFinite(o)){const w=1/(c-o);i[10]=o*w,i[14]=o*c*w}else i[10]=-1,i[14]=-c;return i}function Qn(n,u,c,o=1/0,s){const i=s??new M(16),h=1/Math.tan(n*.5);if(i[0]=h/u,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=h,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=-1,i[12]=0,i[13]=0,i[15]=0,o===1/0)i[10]=0,i[14]=c;else{const w=1/(o-c);i[10]=c*w,i[14]=o*c*w}return i}function fn(n,u,c,o,s,i,h){const w=h??new M(16);return w[0]=2/(u-n),w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=2/(o-c),w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=1/(s-i),w[11]=0,w[12]=(u+n)/(n-u),w[13]=(o+c)/(c-o),w[14]=s/(s-i),w[15]=1,w}function Rn(n,u,c,o,s,i,h){const w=h??new M(16),x=u-n,g=o-c,A=s-i;return w[0]=2*s/x,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=2*s/g,w[6]=0,w[7]=0,w[8]=(n+u)/x,w[9]=(o+c)/g,w[10]=i/A,w[11]=-1,w[12]=0,w[13]=0,w[14]=s*i/A,w[15]=0,w}function tn(n,u,c,o,s,i=1/0,h){const w=h??new M(16),x=u-n,g=o-c;if(w[0]=2*s/x,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=2*s/g,w[6]=0,w[7]=0,w[8]=(n+u)/x,w[9]=(o+c)/g,w[11]=-1,w[12]=0,w[13]=0,w[15]=0,i===1/0)w[10]=0,w[14]=s;else{const A=1/(i-s);w[10]=s*A,w[14]=i*s*A}return w}const Z=y.create(),O=y.create(),U=y.create();function wn(n,u,c,o){const s=o??new M(16);return y.normalize(y.subtract(u,n,U),U),y.normalize(y.cross(c,U,Z),Z),y.normalize(y.cross(U,Z,O),O),s[0]=Z[0],s[1]=Z[1],s[2]=Z[2],s[3]=0,s[4]=O[0],s[5]=O[1],s[6]=O[2],s[7]=0,s[8]=U[0],s[9]=U[1],s[10]=U[2],s[11]=0,s[12]=n[0],s[13]=n[1],s[14]=n[2],s[15]=1,s}function Ln(n,u,c,o){const s=o??new M(16);return y.normalize(y.subtract(n,u,U),U),y.normalize(y.cross(c,U,Z),Z),y.normalize(y.cross(U,Z,O),O),s[0]=Z[0],s[1]=Z[1],s[2]=Z[2],s[3]=0,s[4]=O[0],s[5]=O[1],s[6]=O[2],s[7]=0,s[8]=U[0],s[9]=U[1],s[10]=U[2],s[11]=0,s[12]=n[0],s[13]=n[1],s[14]=n[2],s[15]=1,s}function _(n,u,c,o){const s=o??new M(16);return y.normalize(y.subtract(n,u,U),U),y.normalize(y.cross(c,U,Z),Z),y.normalize(y.cross(U,Z,O),O),s[0]=Z[0],s[1]=O[0],s[2]=U[0],s[3]=0,s[4]=Z[1],s[5]=O[1],s[6]=U[1],s[7]=0,s[8]=Z[2],s[9]=O[2],s[10]=U[2],s[11]=0,s[12]=-(Z[0]*n[0]+Z[1]*n[1]+Z[2]*n[2]),s[13]=-(O[0]*n[0]+O[1]*n[1]+O[2]*n[2]),s[14]=-(U[0]*n[0]+U[1]*n[1]+U[2]*n[2]),s[15]=1,s}function Wn(n,u){const c=u??new M(16);return c[0]=1,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=1,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=1,c[11]=0,c[12]=n[0],c[13]=n[1],c[14]=n[2],c[15]=1,c}function gn(n,u,c){const o=c??new M(16),s=u[0],i=u[1],h=u[2],w=n[0],x=n[1],g=n[2],A=n[3],P=n[1*4+0],q=n[1*4+1],B=n[1*4+2],I=n[1*4+3],F=n[2*4+0],V=n[2*4+1],$=n[2*4+2],G=n[2*4+3],Y=n[3*4+0],j=n[3*4+1],H=n[3*4+2],N=n[3*4+3];return n!==o&&(o[0]=w,o[1]=x,o[2]=g,o[3]=A,o[4]=P,o[5]=q,o[6]=B,o[7]=I,o[8]=F,o[9]=V,o[10]=$,o[11]=G),o[12]=w*s+P*i+F*h+Y,o[13]=x*s+q*i+V*h+j,o[14]=g*s+B*i+$*h+H,o[15]=A*s+I*i+G*h+N,o}function jn(n,u){const c=u??new M(16),o=Math.cos(n),s=Math.sin(n);return c[0]=1,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=o,c[6]=s,c[7]=0,c[8]=0,c[9]=-s,c[10]=o,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}function An(n,u,c){const o=c??new M(16),s=n[4],i=n[5],h=n[6],w=n[7],x=n[8],g=n[9],A=n[10],P=n[11],q=Math.cos(u),B=Math.sin(u);return o[4]=q*s+B*x,o[5]=q*i+B*g,o[6]=q*h+B*A,o[7]=q*w+B*P,o[8]=q*x-B*s,o[9]=q*g-B*i,o[10]=q*A-B*h,o[11]=q*P-B*w,n!==o&&(o[0]=n[0],o[1]=n[1],o[2]=n[2],o[3]=n[3],o[12]=n[12],o[13]=n[13],o[14]=n[14],o[15]=n[15]),o}function On(n,u){const c=u??new M(16),o=Math.cos(n),s=Math.sin(n);return c[0]=o,c[1]=0,c[2]=-s,c[3]=0,c[4]=0,c[5]=1,c[6]=0,c[7]=0,c[8]=s,c[9]=0,c[10]=o,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}function Yn(n,u,c){const o=c??new M(16),s=n[0*4+0],i=n[0*4+1],h=n[0*4+2],w=n[0*4+3],x=n[2*4+0],g=n[2*4+1],A=n[2*4+2],P=n[2*4+3],q=Math.cos(u),B=Math.sin(u);return o[0]=q*s-B*x,o[1]=q*i-B*g,o[2]=q*h-B*A,o[3]=q*w-B*P,o[8]=q*x+B*s,o[9]=q*g+B*i,o[10]=q*A+B*h,o[11]=q*P+B*w,n!==o&&(o[4]=n[4],o[5]=n[5],o[6]=n[6],o[7]=n[7],o[12]=n[12],o[13]=n[13],o[14]=n[14],o[15]=n[15]),o}function p(n,u){const c=u??new M(16),o=Math.cos(n),s=Math.sin(n);return c[0]=o,c[1]=s,c[2]=0,c[3]=0,c[4]=-s,c[5]=o,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=1,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}function z(n,u,c){const o=c??new M(16),s=n[0*4+0],i=n[0*4+1],h=n[0*4+2],w=n[0*4+3],x=n[1*4+0],g=n[1*4+1],A=n[1*4+2],P=n[1*4+3],q=Math.cos(u),B=Math.sin(u);return o[0]=q*s+B*x,o[1]=q*i+B*g,o[2]=q*h+B*A,o[3]=q*w+B*P,o[4]=q*x-B*s,o[5]=q*g-B*i,o[6]=q*A-B*h,o[7]=q*P-B*w,n!==o&&(o[8]=n[8],o[9]=n[9],o[10]=n[10],o[11]=n[11],o[12]=n[12],o[13]=n[13],o[14]=n[14],o[15]=n[15]),o}function a(n,u,c){const o=c??new M(16);let s=n[0],i=n[1],h=n[2];const w=Math.sqrt(s*s+i*i+h*h);s/=w,i/=w,h/=w;const x=s*s,g=i*i,A=h*h,P=Math.cos(u),q=Math.sin(u),B=1-P;return o[0]=x+(1-x)*P,o[1]=s*i*B+h*q,o[2]=s*h*B-i*q,o[3]=0,o[4]=s*i*B-h*q,o[5]=g+(1-g)*P,o[6]=i*h*B+s*q,o[7]=0,o[8]=s*h*B+i*q,o[9]=i*h*B-s*q,o[10]=A+(1-A)*P,o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o}const t=a;function r(n,u,c,o){const s=o??new M(16);let i=u[0],h=u[1],w=u[2];const x=Math.sqrt(i*i+h*h+w*w);i/=x,h/=x,w/=x;const g=i*i,A=h*h,P=w*w,q=Math.cos(c),B=Math.sin(c),I=1-q,F=g+(1-g)*q,V=i*h*I+w*B,$=i*w*I-h*B,G=i*h*I-w*B,Y=A+(1-A)*q,j=h*w*I+i*B,H=i*w*I+h*B,N=h*w*I-i*B,m=P+(1-P)*q,sn=n[0],cn=n[1],en=n[2],on=n[3],rn=n[4],an=n[5],hn=n[6],ln=n[7],Mn=n[8],In=n[9],Vn=n[10],$n=n[11];return s[0]=F*sn+V*rn+$*Mn,s[1]=F*cn+V*an+$*In,s[2]=F*en+V*hn+$*Vn,s[3]=F*on+V*ln+$*$n,s[4]=G*sn+Y*rn+j*Mn,s[5]=G*cn+Y*an+j*In,s[6]=G*en+Y*hn+j*Vn,s[7]=G*on+Y*ln+j*$n,s[8]=H*sn+N*rn+m*Mn,s[9]=H*cn+N*an+m*In,s[10]=H*en+N*hn+m*Vn,s[11]=H*on+N*ln+m*$n,n!==s&&(s[12]=n[12],s[13]=n[13],s[14]=n[14],s[15]=n[15]),s}const e=r;function f(n,u){const c=u??new M(16);return c[0]=n[0],c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=n[1],c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=n[2],c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}function l(n,u,c){const o=c??new M(16),s=u[0],i=u[1],h=u[2];return o[0]=s*n[0*4+0],o[1]=s*n[0*4+1],o[2]=s*n[0*4+2],o[3]=s*n[0*4+3],o[4]=i*n[1*4+0],o[5]=i*n[1*4+1],o[6]=i*n[1*4+2],o[7]=i*n[1*4+3],o[8]=h*n[2*4+0],o[9]=h*n[2*4+1],o[10]=h*n[2*4+2],o[11]=h*n[2*4+3],n!==o&&(o[12]=n[12],o[13]=n[13],o[14]=n[14],o[15]=n[15]),o}function D(n,u){const c=u??new M(16);return c[0]=n,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=n,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=n,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}function d(n,u,c){const o=c??new M(16);return o[0]=u*n[0*4+0],o[1]=u*n[0*4+1],o[2]=u*n[0*4+2],o[3]=u*n[0*4+3],o[4]=u*n[1*4+0],o[5]=u*n[1*4+1],o[6]=u*n[1*4+2],o[7]=u*n[1*4+3],o[8]=u*n[2*4+0],o[9]=u*n[2*4+1],o[10]=u*n[2*4+2],o[11]=u*n[2*4+3],n!==o&&(o[12]=n[12],o[13]=n[13],o[14]=n[14],o[15]=n[15]),o}return{add:C,aim:wn,axisRotate:r,axisRotation:a,cameraAim:Ln,clone:k,copy:v,create:E,determinant:Tn,equals:pn,equalsApproximately:_n,fromMat3:R,fromQuat:L,frustum:Rn,frustumReverseZ:tn,getAxis:Zn,getScaling:Pn,getTranslation:qn,identity:zn,inverse:Fn,invert:yn,lookAt:_,mul:Un,mulScalar:dn,multiply:nn,multiplyScalar:K,negate:Dn,ortho:fn,perspective:b,perspectiveReverseZ:Qn,rotate:e,rotateX:An,rotateY:Yn,rotateZ:z,rotation:t,rotationX:jn,rotationY:On,rotationZ:p,scale:l,scaling:f,set:X,setAxis:Bn,setTranslation:Sn,translate:gn,translation:Wn,transpose:xn,uniformScale:d,uniformScaling:D}}const Ut=new Map;function kt(M){let y=Ut.get(M);return y||(y=Kt(M),Ut.set(M,y)),y}function vt(M){const y=gt(M);function E(p,z,a,t){const r=new M(4);return p!==void 0&&(r[0]=p,z!==void 0&&(r[1]=z,a!==void 0&&(r[2]=a,t!==void 0&&(r[3]=t)))),r}const X=E;function R(p,z,a,t,r){const e=r??new M(4);return e[0]=p,e[1]=z,e[2]=a,e[3]=t,e}function L(p,z,a){const t=a??new M(4),r=z*.5,e=Math.sin(r);return t[0]=e*p[0],t[1]=e*p[1],t[2]=e*p[2],t[3]=Math.cos(r),t}function Dn(p,z){const a=z??y.create(3),t=Math.acos(p[3])*2,r=Math.sin(t*.5);return r>T?(a[0]=p[0]/r,a[1]=p[1]/r,a[2]=p[2]/r):(a[0]=1,a[1]=0,a[2]=0),{angle:t,axis:a}}function C(p,z){const a=b(p,z);return Math.acos(2*a*a-1)}function K(p,z,a){const t=a??new M(4),r=p[0],e=p[1],f=p[2],l=p[3],D=z[0],d=z[1],n=z[2],u=z[3];return t[0]=r*u+l*D+e*n-f*d,t[1]=e*u+l*d+f*D-r*n,t[2]=f*u+l*n+r*d-e*D,t[3]=l*u-r*D-e*d-f*n,t}const dn=K;function v(p,z,a){const t=a??new M(4),r=z*.5,e=p[0],f=p[1],l=p[2],D=p[3],d=Math.sin(r),n=Math.cos(r);return t[0]=e*n+D*d,t[1]=f*n+l*d,t[2]=l*n-f*d,t[3]=D*n-e*d,t}function k(p,z,a){const t=a??new M(4),r=z*.5,e=p[0],f=p[1],l=p[2],D=p[3],d=Math.sin(r),n=Math.cos(r);return t[0]=e*n-l*d,t[1]=f*n+D*d,t[2]=l*n+e*d,t[3]=D*n-f*d,t}function _n(p,z,a){const t=a??new M(4),r=z*.5,e=p[0],f=p[1],l=p[2],D=p[3],d=Math.sin(r),n=Math.cos(r);return t[0]=e*n+f*d,t[1]=f*n-e*d,t[2]=l*n+D*d,t[3]=D*n-l*d,t}function pn(p,z,a,t){const r=t??new M(4),e=p[0],f=p[1],l=p[2],D=p[3];let d=z[0],n=z[1],u=z[2],c=z[3],o=e*d+f*n+l*u+D*c;o<0&&(o=-o,d=-d,n=-n,u=-u,c=-c);let s,i;if(1-o>T){const h=Math.acos(o),w=Math.sin(h);s=Math.sin((1-a)*h)/w,i=Math.sin(a*h)/w}else s=1-a,i=a;return r[0]=s*e+i*d,r[1]=s*f+i*n,r[2]=s*l+i*u,r[3]=s*D+i*c,r}function zn(p,z){const a=z??new M(4),t=p[0],r=p[1],e=p[2],f=p[3],l=t*t+r*r+e*e+f*f,D=l?1/l:0;return a[0]=-t*D,a[1]=-r*D,a[2]=-e*D,a[3]=f*D,a}function xn(p,z){const a=z??new M(4);return a[0]=-p[0],a[1]=-p[1],a[2]=-p[2],a[3]=p[3],a}function Fn(p,z){const a=z??new M(4),t=p[0]+p[5]+p[10];if(t>0){const r=Math.sqrt(t+1);a[3]=.5*r;const e=.5/r;a[0]=(p[6]-p[9])*e,a[1]=(p[8]-p[2])*e,a[2]=(p[1]-p[4])*e}else{let r=0;p[5]>p[0]&&(r=1),p[10]>p[r*4+r]&&(r=2);const e=(r+1)%3,f=(r+2)%3,l=Math.sqrt(p[r*4+r]-p[e*4+e]-p[f*4+f]+1);a[r]=.5*l;const D=.5/l;a[3]=(p[e*4+f]-p[f*4+e])*D,a[e]=(p[e*4+r]+p[r*4+e])*D,a[f]=(p[f*4+r]+p[r*4+f])*D}return a}function Tn(p,z,a,t,r){const e=r??new M(4),f=p*.5,l=z*.5,D=a*.5,d=Math.sin(f),n=Math.cos(f),u=Math.sin(l),c=Math.cos(l),o=Math.sin(D),s=Math.cos(D);switch(t){case"xyz":e[0]=d*c*s+n*u*o,e[1]=n*u*s-d*c*o,e[2]=n*c*o+d*u*s,e[3]=n*c*s-d*u*o;break;case"xzy":e[0]=d*c*s-n*u*o,e[1]=n*u*s-d*c*o,e[2]=n*c*o+d*u*s,e[3]=n*c*s+d*u*o;break;case"yxz":e[0]=d*c*s+n*u*o,e[1]=n*u*s-d*c*o,e[2]=n*c*o-d*u*s,e[3]=n*c*s+d*u*o;break;case"yzx":e[0]=d*c*s+n*u*o,e[1]=n*u*s+d*c*o,e[2]=n*c*o-d*u*s,e[3]=n*c*s-d*u*o;break;case"zxy":e[0]=d*c*s-n*u*o,e[1]=n*u*s+d*c*o,e[2]=n*c*o+d*u*s,e[3]=n*c*s-d*u*o;break;case"zyx":e[0]=d*c*s-n*u*o,e[1]=n*u*s+d*c*o,e[2]=n*c*o-d*u*s,e[3]=n*c*s+d*u*o;break;default:throw new Error(`Unknown rotation order: ${t}`)}return e}function yn(p,z){const a=z??new M(4);return a[0]=p[0],a[1]=p[1],a[2]=p[2],a[3]=p[3],a}const nn=yn;function Un(p,z,a){const t=a??new M(4);return t[0]=p[0]+z[0],t[1]=p[1]+z[1],t[2]=p[2]+z[2],t[3]=p[3]+z[3],t}function Sn(p,z,a){const t=a??new M(4);return t[0]=p[0]-z[0],t[1]=p[1]-z[1],t[2]=p[2]-z[2],t[3]=p[3]-z[3],t}const qn=Sn;function Zn(p,z,a){const t=a??new M(4);return t[0]=p[0]*z,t[1]=p[1]*z,t[2]=p[2]*z,t[3]=p[3]*z,t}const Bn=Zn;function Pn(p,z,a){const t=a??new M(4);return t[0]=p[0]/z,t[1]=p[1]/z,t[2]=p[2]/z,t[3]=p[3]/z,t}function b(p,z){return p[0]*z[0]+p[1]*z[1]+p[2]*z[2]+p[3]*z[3]}function Qn(p,z,a,t){const r=t??new M(4);return r[0]=p[0]+a*(z[0]-p[0]),r[1]=p[1]+a*(z[1]-p[1]),r[2]=p[2]+a*(z[2]-p[2]),r[3]=p[3]+a*(z[3]-p[3]),r}function fn(p){const z=p[0],a=p[1],t=p[2],r=p[3];return Math.sqrt(z*z+a*a+t*t+r*r)}const Rn=fn;function tn(p){const z=p[0],a=p[1],t=p[2],r=p[3];return z*z+a*a+t*t+r*r}const Z=tn;function O(p,z){const a=z??new M(4),t=p[0],r=p[1],e=p[2],f=p[3],l=Math.sqrt(t*t+r*r+e*e+f*f);return l>1e-5?(a[0]=t/l,a[1]=r/l,a[2]=e/l,a[3]=f/l):(a[0]=0,a[1]=0,a[2]=0,a[3]=1),a}function U(p,z){return Math.abs(p[0]-z[0])<T&&Math.abs(p[1]-z[1])<T&&Math.abs(p[2]-z[2])<T&&Math.abs(p[3]-z[3])<T}function wn(p,z){return p[0]===z[0]&&p[1]===z[1]&&p[2]===z[2]&&p[3]===z[3]}function Ln(p){const z=p??new M(4);return z[0]=0,z[1]=0,z[2]=0,z[3]=1,z}const _=y.create(),Wn=y.create(),gn=y.create();function jn(p,z,a){const t=a??new M(4),r=y.dot(p,z);return r<-.999999?(y.cross(Wn,p,_),y.len(_)<1e-6&&y.cross(gn,p,_),y.normalize(_,_),L(_,Math.PI,t),t):r>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(y.cross(p,z,_),t[0]=_[0],t[1]=_[1],t[2]=_[2],t[3]=1+r,O(t,t))}const An=new M(4),On=new M(4);function Yn(p,z,a,t,r,e){const f=e??new M(4);return pn(p,t,r,An),pn(z,a,r,On),pn(An,On,2*r*(1-r),f),f}return{create:E,fromValues:X,set:R,fromAxisAngle:L,toAxisAngle:Dn,angle:C,multiply:K,mul:dn,rotateX:v,rotateY:k,rotateZ:_n,slerp:pn,inverse:zn,conjugate:xn,fromMat:Fn,fromEuler:Tn,copy:yn,clone:nn,add:Un,subtract:Sn,sub:qn,mulScalar:Zn,scale:Bn,divScalar:Pn,dot:b,lerp:Qn,length:fn,len:Rn,lengthSq:tn,lenSq:Z,normalize:O,equalsApproximately:U,equals:wn,identity:Ln,rotationTo:jn,sqlerp:Yn}}const Zt=new Map;function bt(M){let y=Zt.get(M);return y||(y=vt(M),Zt.set(M,y)),y}function mt(M){function y(a,t,r,e){const f=new M(4);return a!==void 0&&(f[0]=a,t!==void 0&&(f[1]=t,r!==void 0&&(f[2]=r,e!==void 0&&(f[3]=e)))),f}const E=y;function X(a,t,r,e,f){const l=f??new M(4);return l[0]=a,l[1]=t,l[2]=r,l[3]=e,l}function R(a,t){const r=t??new M(4);return r[0]=Math.ceil(a[0]),r[1]=Math.ceil(a[1]),r[2]=Math.ceil(a[2]),r[3]=Math.ceil(a[3]),r}function L(a,t){const r=t??new M(4);return r[0]=Math.floor(a[0]),r[1]=Math.floor(a[1]),r[2]=Math.floor(a[2]),r[3]=Math.floor(a[3]),r}function Dn(a,t){const r=t??new M(4);return r[0]=Math.round(a[0]),r[1]=Math.round(a[1]),r[2]=Math.round(a[2]),r[3]=Math.round(a[3]),r}function C(a,t=0,r=1,e){const f=e??new M(4);return f[0]=Math.min(r,Math.max(t,a[0])),f[1]=Math.min(r,Math.max(t,a[1])),f[2]=Math.min(r,Math.max(t,a[2])),f[3]=Math.min(r,Math.max(t,a[3])),f}function K(a,t,r){const e=r??new M(4);return e[0]=a[0]+t[0],e[1]=a[1]+t[1],e[2]=a[2]+t[2],e[3]=a[3]+t[3],e}function dn(a,t,r,e){const f=e??new M(4);return f[0]=a[0]+t[0]*r,f[1]=a[1]+t[1]*r,f[2]=a[2]+t[2]*r,f[3]=a[3]+t[3]*r,f}function v(a,t,r){const e=r??new M(4);return e[0]=a[0]-t[0],e[1]=a[1]-t[1],e[2]=a[2]-t[2],e[3]=a[3]-t[3],e}const k=v;function _n(a,t){return Math.abs(a[0]-t[0])<T&&Math.abs(a[1]-t[1])<T&&Math.abs(a[2]-t[2])<T&&Math.abs(a[3]-t[3])<T}function pn(a,t){return a[0]===t[0]&&a[1]===t[1]&&a[2]===t[2]&&a[3]===t[3]}function zn(a,t,r,e){const f=e??new M(4);return f[0]=a[0]+r*(t[0]-a[0]),f[1]=a[1]+r*(t[1]-a[1]),f[2]=a[2]+r*(t[2]-a[2]),f[3]=a[3]+r*(t[3]-a[3]),f}function xn(a,t,r,e){const f=e??new M(4);return f[0]=a[0]+r[0]*(t[0]-a[0]),f[1]=a[1]+r[1]*(t[1]-a[1]),f[2]=a[2]+r[2]*(t[2]-a[2]),f[3]=a[3]+r[3]*(t[3]-a[3]),f}function Fn(a,t,r){const e=r??new M(4);return e[0]=Math.max(a[0],t[0]),e[1]=Math.max(a[1],t[1]),e[2]=Math.max(a[2],t[2]),e[3]=Math.max(a[3],t[3]),e}function Tn(a,t,r){const e=r??new M(4);return e[0]=Math.min(a[0],t[0]),e[1]=Math.min(a[1],t[1]),e[2]=Math.min(a[2],t[2]),e[3]=Math.min(a[3],t[3]),e}function yn(a,t,r){const e=r??new M(4);return e[0]=a[0]*t,e[1]=a[1]*t,e[2]=a[2]*t,e[3]=a[3]*t,e}const nn=yn;function Un(a,t,r){const e=r??new M(4);return e[0]=a[0]/t,e[1]=a[1]/t,e[2]=a[2]/t,e[3]=a[3]/t,e}function Sn(a,t){const r=t??new M(4);return r[0]=1/a[0],r[1]=1/a[1],r[2]=1/a[2],r[3]=1/a[3],r}const qn=Sn;function Zn(a,t){return a[0]*t[0]+a[1]*t[1]+a[2]*t[2]+a[3]*t[3]}function Bn(a){const t=a[0],r=a[1],e=a[2],f=a[3];return Math.sqrt(t*t+r*r+e*e+f*f)}const Pn=Bn;function b(a){const t=a[0],r=a[1],e=a[2],f=a[3];return t*t+r*r+e*e+f*f}const Qn=b;function fn(a,t){const r=a[0]-t[0],e=a[1]-t[1],f=a[2]-t[2],l=a[3]-t[3];return Math.sqrt(r*r+e*e+f*f+l*l)}const Rn=fn;function tn(a,t){const r=a[0]-t[0],e=a[1]-t[1],f=a[2]-t[2],l=a[3]-t[3];return r*r+e*e+f*f+l*l}const Z=tn;function O(a,t){const r=t??new M(4),e=a[0],f=a[1],l=a[2],D=a[3],d=Math.sqrt(e*e+f*f+l*l+D*D);return d>1e-5?(r[0]=e/d,r[1]=f/d,r[2]=l/d,r[3]=D/d):(r[0]=0,r[1]=0,r[2]=0,r[3]=0),r}function U(a,t){const r=t??new M(4);return r[0]=-a[0],r[1]=-a[1],r[2]=-a[2],r[3]=-a[3],r}function wn(a,t){const r=t??new M(4);return r[0]=a[0],r[1]=a[1],r[2]=a[2],r[3]=a[3],r}const Ln=wn;function _(a,t,r){const e=r??new M(4);return e[0]=a[0]*t[0],e[1]=a[1]*t[1],e[2]=a[2]*t[2],e[3]=a[3]*t[3],e}const Wn=_;function gn(a,t,r){const e=r??new M(4);return e[0]=a[0]/t[0],e[1]=a[1]/t[1],e[2]=a[2]/t[2],e[3]=a[3]/t[3],e}const jn=gn;function An(a){const t=a??new M(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t}function On(a,t,r){const e=r??new M(4),f=a[0],l=a[1],D=a[2],d=a[3];return e[0]=t[0]*f+t[4]*l+t[8]*D+t[12]*d,e[1]=t[1]*f+t[5]*l+t[9]*D+t[13]*d,e[2]=t[2]*f+t[6]*l+t[10]*D+t[14]*d,e[3]=t[3]*f+t[7]*l+t[11]*D+t[15]*d,e}function Yn(a,t,r){const e=r??new M(4);return O(a,e),yn(e,t,e)}function p(a,t,r){const e=r??new M(4);return Bn(a)>t?Yn(a,t,e):wn(a,e)}function z(a,t,r){const e=r??new M(4);return zn(a,t,.5,e)}return{create:y,fromValues:E,set:X,ceil:R,floor:L,round:Dn,clamp:C,add:K,addScaled:dn,subtract:v,sub:k,equalsApproximately:_n,equals:pn,lerp:zn,lerpV:xn,max:Fn,min:Tn,mulScalar:yn,scale:nn,divScalar:Un,inverse:Sn,invert:qn,dot:Zn,length:Bn,len:Pn,lengthSq:b,lenSq:Qn,distance:fn,dist:Rn,distanceSq:tn,distSq:Z,normalize:O,negate:U,copy:wn,clone:Ln,multiply:_,mul:Wn,divide:gn,div:jn,zero:An,transformMat4:On,setLength:Yn,truncate:p,midpoint:z}}const Ot=new Map;function Ct(M){let y=Ot.get(M);return y||(y=mt(M),Ot.set(M,y)),y}function St(M,y,E,X,R,L){return{mat3:Jt(M),mat4:kt(y),quat:bt(E),vec2:Gt(X),vec3:gt(R),vec4:Ct(L)}}const{mat3:Hn,vec2:Yt}=St(Float32Array,Float32Array,Float32Array,Float32Array,Float32Array,Float32Array);St(Float64Array,Float64Array,Float64Array,Float64Array,Float64Array,Float64Array);St(Wt,Array,Array,Array,Array,Array);var Gn,ot,Jn,ft,wt,at,ht,vn,Kn,it,W,nt,En,bn,kn,mn,tt,st,Xn,rt,ct,ut,Cn,Nn,Xt,_t,Qt,zt;class cs{constructor(y){Q(this,Nn);Q(this,Gn);Q(this,ot,0);Q(this,Jn,!1);Q(this,ft,Hn.create());Q(this,wt,Hn.create());Q(this,at,Hn.create());Q(this,ht,Hn.create());Q(this,vn);Q(this,Kn);Q(this,it);Q(this,W);Q(this,nt);Q(this,En);Q(this,bn);Q(this,kn);Q(this,mn,[]);Q(this,tt,[void 0]);Q(this,st,new Float32Array([1,1]));Q(this,Xn,new Float32Array([0,0]));Q(this,rt,new Float32Array([0,0]));Q(this,ct,new Float32Array([0,0]));Q(this,ut);Q(this,Cn,$t({min:Yt.create(),max:Yt.create()}));J(this,vn,y.label??"Shape"),J(this,Gn,y.radius??0),J(this,W,y.renderer),J(this,Kn,y.segments);const{startAngle:E,endAngle:X,innerRadius:R}=y;et(this,Nn,Xt).call(this,E,X,R),et(this,Nn,_t).call(this),et(this,Nn,Qt).call(this),this.Scale=S(this,st),this.Origin=S(this,Xn),this.Rotation=S(this,ot),this.Position=S(this,ct)}Update(){return S(this,W).SetVertexBuffers(S(this,mn)),S(this,W).SetIndexBuffer(S(this,bn)),S(this,W).SetBindGroups(S(this,tt)),et(this,Nn,zt).call(this)}Render(y=!0){S(this,W).SavePipelineState(),S(this,W).Render(S(this.Update(),it),y),S(this,W).RestorePipelineState()}AddBindGroups(y){S(this,tt).push(...Array.isArray(y)&&y||[y])}AddVertexBuffers(y){S(this,mn).push(...Array.isArray(y)&&y||[y])}set Color(y){S(this,nt).set(Array.isArray(y)||ArrayBuffer.isView(y)?y:y.rgba),S(this,W).WriteBuffer(S(this,kn),S(this,nt),S(this,ut).color)}get Color(){return S(this,nt)}set Position(y){S(this,ct).set(y),Hn.translation(S(this,ct),S(this,ht)),J(this,Jn,!0)}get Position(){return S(this,ct)}set Rotation(y){Hn.rotation(J(this,ot,y),S(this,at)),J(this,Jn,!0)}get Rotation(){return S(this,ot)}set Scale(y){S(this,st).set(y),Hn.scaling(S(this,st),S(this,wt)),J(this,Jn,!0)}get Scale(){return S(this,st)}set Origin(y){S(this,Xn)[0]=y[0],S(this,Xn)[1]=y[1],S(this,Xn)[0]*=-S(this,Gn),S(this,Xn)[1]*=-S(this,Gn),Hn.translation(S(this,Xn),S(this,ft)),S(this,Xn)[0]=y[0]||0,S(this,Xn)[1]=y[1]||0,J(this,Jn,!0)}get Origin(){return S(this,Xn)}get Center(){return S(et(this,Nn,zt).call(this),rt)}get Vertices(){return S(this,it)}get Transform(){return S(this,En)}get BoundingBox(){return S(this,Cn)}Destroy(){S(this,mn).forEach(y=>y.destroy()),J(this,kn,S(this,kn).destroy()),J(this,bn,S(this,bn).destroy()),S(this,mn).splice(0),S(this,tt).splice(0)}}Gn=new WeakMap,ot=new WeakMap,Jn=new WeakMap,ft=new WeakMap,wt=new WeakMap,at=new WeakMap,ht=new WeakMap,vn=new WeakMap,Kn=new WeakMap,it=new WeakMap,W=new WeakMap,nt=new WeakMap,En=new WeakMap,bn=new WeakMap,kn=new WeakMap,mn=new WeakMap,tt=new WeakMap,st=new WeakMap,Xn=new WeakMap,rt=new WeakMap,ct=new WeakMap,ut=new WeakMap,Cn=new WeakMap,Nn=new WeakSet,Xt=function(y=0,E=Rt.TAU,X=0){const R=E-y,L=new Float32Array((S(this,Kn)+1)*2*3);for(let C=0,K=0;K<=S(this,Kn);++K){const dn=y+K*R/S(this,Kn),v=Math.cos(dn),k=Math.sin(dn);L[C++]=v*S(this,Gn),L[C++]=k*S(this,Gn),L[C++]=v*X,L[C++]=k*X}const Dn=S(this,W).CreateVertexBuffer(L,{label:`${S(this,vn)} Vertex Buffer`});S(this,W).WriteBuffer(Dn,L),S(this,mn).push(Dn)},_t=function(){const y=new Uint32Array(J(this,it,S(this,Kn)*6));for(let E=0,X=0;X<S(this,Kn);++X){const R=X*2;y[E++]=R+1,y[E++]=R+3,y[E++]=R+2,y[E++]=R+2,y[E++]=R+0,y[E++]=R+1}J(this,bn,S(this,W).CreateIndexBuffer(y,{label:`${S(this,vn)} Index Buffer`})),S(this,W).WriteBuffer(S(this,bn),y)},Qt=function(){const{buffer:y,shape:{color:E,matrix:X}}=S(this,W).CreateUniformBuffer("shape",{label:`${S(this,vn)} Uniform Buffer`});J(this,kn,y),J(this,En,X),J(this,nt,E),S(this,tt)[0]=S(this,W).CreateBindGroup(S(this,W).CreateBindGroupEntries([{buffer:S(this,W).ResolutionBuffer},{buffer:S(this,kn)}]),0,`${S(this,vn)} Bind Group`),J(this,ut,$t({matrix:E.length*Float32Array.BYTES_PER_ELEMENT,color:0*Float32Array.BYTES_PER_ELEMENT}))},zt=function(){if(S(this,Jn)){Hn.multiply(S(this,ht),S(this,at),S(this,En)),Hn.multiply(S(this,En),S(this,wt),S(this,En)),Hn.multiply(S(this,En),S(this,ft),S(this,En)),S(this,W).WriteBuffer(S(this,kn),S(this,En),S(this,ut).matrix);const y=S(this,rt)[0]=S(this,En)[8],E=S(this,rt)[1]=S(this,En)[9];S(this,Cn).min[0]=y-S(this,Gn),S(this,Cn).min[1]=E-S(this,Gn),S(this,Cn).max[0]=y+S(this,Gn),S(this,Cn).max[1]=E+S(this,Gn),J(this,Jn,!1)}return this};export{ss as S,cs as a};
