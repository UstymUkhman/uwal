import{G as $,C as x,D as v}from"./index-DHkQdOh-.js";import{S as F,a as B,b as M}from"./Shape-4-l3O7pN.js";import{M as o}from"./Math-Cr7J2GA5.js";var U="@group(0)@binding(2)var<uniform>color: vec4f;@fragment fn fragment()->@location(0)vec4f {return color;}";const _=`${F}

${U}`;class G{#t;#n;#o;#e;constructor(t=16777215){this.Color=t}CreateColorBuffer(t,h="Shape"){const{color:i,buffer:f}=t.CreateUniformBuffer("color",{label:`${h} Color Buffer`});this.#t=i,this.#n=t,this.#e=f,this.#t.set(this.#o),t.WriteBuffer(f,i)}get ColorBuffer(){return this.#e}set Color(t){this.#o=typeof t=="number"&&$(t)||t instanceof x&&t.rgba||Object.values(t),this.#t?.fill(1).set(this.#o),this.#n?.WriteBuffer(this.#e,this.#t)}get Color(){return this.#o}Destroy(){this.#n=void 0,this.#e.destroy(),this.#e=void 0}}/**
 * @example 2D Shapes
 * @author Ustym Ukhman <ustym.ukhman@gmail.com>
 * @description This example is developed by using a version listed below.
 * Please note that this code may be simplified in future
 * thanks to more recent library APIs.
 * @version 0.2.0
 * @license MIT
 */let R,r;const d=[];let y;async function V(p){try{r=new(await v.Renderer(p,"2D Shapes"))}catch(s){alert(s)}const t=new x(3349069),h=[],i=[],f=[],c=new r.Pipeline,b=c.CreateShaderModule(_);await r.AddPipeline(c,{fragment:c.CreateFragmentState(b),vertex:c.CreateVertexState(b,B.GetPositionBufferLayout(c))}),r.CreatePassDescriptor(r.CreateColorAttachment(t));function D(){h.splice(0),i.splice(0),d.splice(0),f.splice(0),cancelAnimationFrame(R)}function P(){A(),R=requestAnimationFrame(w)}function g(){return t.rgb=[o.Random(.3),o.Random(.2),o.Random(.4)]}function A(){const[s,u]=r.CanvasSize;for(let e=3;e<=12;e++){const m=e===11&&64||e;for(let n=0;n<2;n++){const a=o.Random(50,100),C=o.Random(.75,.95)*a,S=new M({segments:m,radius:a,innerRadius:C*n}),l=new B(S,new G(g()));l.SetRenderPipeline(c,r.ResolutionBuffer),l.Rotation=o.Random(0,o.TAU),l.Position=[o.Random(a,s-a),o.Random(a,u-a)],i.push(o.Random(1,10)),h.push(o.Random(0,.1)),f.push([o.Random(-1,1),o.Random(-1,1)]),d.push(l)}}}function w(){const[s,u]=r.CanvasSize;for(let e=0,m=d.length;e<m;e++){const n=d[e],a=f[e],{min:C,max:S}=n.BoundingBox,[l,z]=n.Position;(C[0]<=0||S[0]>=s)&&(a[0]*=-1,n.Material.Color=g()),(C[1]<=0||S[1]>=u)&&(a[1]*=-1,n.Material.Color=g()),n.Position=[l+a[0]*i[e],z+a[1]*i[e]],n.Rotation+=h[e],n.Update(),n.SetPipelineData(),r.Render(!1)}r.Submit(),R=requestAnimationFrame(w)}y=new ResizeObserver(s=>{for(const u of s){let{inlineSize:e,blockSize:m}=u.contentBoxSize[0];e=e<=960&&e||e-240,r.SetCanvasSize(e,m)}D(),P()}),y.observe(document.body)}function W(){d.forEach(p=>p.Destroy()),v.OnLost=()=>{},cancelAnimationFrame(R),y.disconnect(),r.Destroy(),d.splice(0),v.Destroy()}export{W as destroy,V as run};
