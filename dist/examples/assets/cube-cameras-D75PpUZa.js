import{_ as e,a as t,c as n,d as r,f as i,n as a,o,p as s,r as c,y as l}from"./lib-CEvTfSHs.js";var u=``+new URL(`dice-Vcs4qiRq.jpg`,import.meta.url).href,d=`struct VertexOutput{@location(0)textureCoords: vec2f,@builtin(position)position: vec4f};@group(0)@binding(1)var Sampler: sampler;@group(0)@binding(2)var Texture: texture_2d<f32>;@vertex fn cubeVertex(@location(0)position: vec4f,@location(1)textureCoords: vec2f)->VertexOutput {return VertexOutput(textureCoords,GetVertexClipSpace(position));}@fragment fn fragment(@location(0)textureCoords: vec2f)->@location(0)vec4f {return textureSample(Texture,Sampler,textureCoords);}`,f,p,m,h,g=new o;async function _(o){try{p=new(await(s.Renderer(o,`Cube / Cameras`)))}catch(e){alert(e)}let _,v,y,b=1/0,x=new n,S=new p.Pipeline,C=i.Vec3.create(),w=new a,T=new c,E=i.Vec3.create(),D=i.Vec3.create(),O=new t(x,null),k=new t(x,null),A=i.Vec3.create(),j=i.Vec3.create(),M=i.Vec3.create(),N=S.CreateShaderModule([e,d]),{buffer:P,layout:F}=x.CreateTextureCoordsBuffer(S,void 0,void 0,`cubeVertex`);await p.AddPipeline(S,{primitive:S.CreatePrimitiveState(),fragment:S.CreateFragmentState(N),multisample:S.CreateMultisampleState(),depthStencil:S.CreateDepthStencilState(),vertex:S.CreateVertexState(N,[x.GetPositionBufferLayout(S),F],void 0,`cubeVertex`)});let I=new(await(s.Texture(p))),L=await I.CreateImageBitmap(u);m=await I.CopyImageToTexture(L),k.SetRenderPipeline(S,[I.CreateSampler({filter:l.LINEAR}),m.createView()]),O.SetRenderPipeline(S,[I.CreateSampler({filter:l.LINEAR}),m.createView()]),p.CreatePassDescriptor(p.CreateColorAttachment(new r(1657907)),p.CreateDepthStencilAttachment()),S.AddVertexBuffers(P),S.AddVertexBuffers(P),g.Add([O,k]),g.AddCamera(T),g.AddCamera(w);function R(){b=1/0,clearTimeout(y),cancelAnimationFrame(f)}function z(){y=setTimeout(()=>{let e=-_||0,t=i.RandomInt(-2,2)||1/0,n=i.RandomInt(-2,2)||1/0,r=i.RandomInt(-2,2)||1/0;A[0]=Math.PI/t,A[1]=Math.PI/n,A[2]=Math.PI/r,j[0]=Math.PI/t+_,j[1]=!isFinite(t)&&_||Math.abs(t)<2&&e,j[2]=Math.abs(t)===2&&Math.sign(t)*e,j[1]&&=j[1]+Math.PI/n,j[2]&&=j[2]+Math.PI/r,b=Date.now()},1e3)}function B(e){f=requestAnimationFrame(B),e=(Date.now()-b)/1e3;let t=i.SmoothStep(e),n=i.SmootherStep(e*2);.5<=t&&(n=(.5-(t-.5))*2,t===1&&(i.Vec3.copy(A,M),i.Vec3.copy(j,D),b=1/0,z()));{let[e,r,a]=M;C[0]=i.Lerp(e,A[0],t),C[1]=i.Lerp(r,A[1],t),C[2]=i.Lerp(a,A[2],t),O.Transform=[[0,i.Lerp(0,4,n),0],C],O.Visible=!(k.Visible=!1),g.MainCamera=w,p.Render(g,!1)}{let[e,r,a]=E,[o,s,c]=D;C[0]=i.Lerp(o,j[0],t),C[1]=i.Lerp(s,j[1],t),C[2]=i.Lerp(c,j[2],t),k.Transform=[[e,i.Lerp(r,v,n),a],C],k.Visible=!(O.Visible=!1),g.MainCamera=T,p.Render(g)}}h=new ResizeObserver(e=>{for(let t of e){let{inlineSize:e,blockSize:n}=t.contentBoxSize[0];e=e<=960&&e||e-Math.max(e*.15,240),p.SetCanvasSize(e,n),w.ResetLocalMatrix(),T.Bottom=n,T.Right=e,T.Near=-100,p.MultisampleTexture=I.CreateMultisampleTexture(),w.AspectRatio=p.AspectRatio,w.Position=[e/360,2,8],T.UpdateViewProjectionMatrix(),w.UpdateViewProjectionMatrix();let r=n-n/3.6,a=(e-360)/1320;_=a*.2+.1,v=r*.39;let o=a+1;O.Scaling=[o,o,o];let s=(1-(n-1e3)/-400)*36+72;k.Scaling=[s*o,s*o,s*o],i.Vec3.set(.2,_,0,D),i.Vec3.set(e-(a*250+100),r,0,E)}R(),z(),f=requestAnimationFrame(B)}),h.observe(document.body)}function v(){s.OnLost=()=>void 0,cancelAnimationFrame(f),h.disconnect(),p.Destroy(),g.Destroy(),s.Destroy(void 0,m)}export{v as destroy,_ as run};