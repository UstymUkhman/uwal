import{d as e,f as t,l as n,n as r,o as i,p as a,r as o,s,v as c,y as l}from"./lib-B0aPbQsN.js";var u=``+new URL(`dice-Vcs4qiRq.jpg`,import.meta.url).href,d=`struct VertexOutput{@location(0)textureCoords: vec2f,@builtin(position)position: vec4f};@group(0)@binding(1)var Sampler: sampler;@group(0)@binding(2)var Texture: texture_2d<f32>;@vertex fn cubeVertex(@location(0)position: vec4f,@location(1)textureCoords: vec2f)->VertexOutput {return VertexOutput(textureCoords,GetVertexClipSpace(position));}@fragment fn fragment(@location(0)textureCoords: vec2f)->@location(0)vec4f {return textureSample(Texture,Sampler,textureCoords);}`,f,p,m,h,g=new s;async function _(s){try{p=new(await(a.Renderer(s,`Cube / Cameras`)))}catch(e){alert(e)}let _,v,y,b=1/0,x=new i,S=new p.Pipeline,C=t.Vec3.create(),w=new r,T=new o,E=t.Vec3.create(),D=t.Vec3.create(),O=new n(x,null),k=new n(x,null),A=t.Vec3.create(),j=t.Vec3.create(),M=t.Vec3.create(),N=S.CreateShaderModule([c,d]),{buffer:P,layout:F}=x.CreateTextureCoordsBuffer(S,void 0,void 0,`cubeVertex`);await p.AddPipeline(S,{primitive:S.CreatePrimitiveState(),fragment:S.CreateFragmentState(N),multisample:S.CreateMultisampleState(),depthStencil:S.CreateDepthStencilState(),vertex:S.CreateVertexState(N,[x.GetPositionBufferLayout(S),F],void 0,`cubeVertex`)});let I=new(await(a.Texture(p))),L=await I.CreateImageBitmap(u);m=await I.CopyImageToTexture(L),k.SetRenderPipeline(S,[I.CreateSampler({filter:l.LINEAR}),m.createView()]),O.SetRenderPipeline(S,[I.CreateSampler({filter:l.LINEAR}),m.createView()]),p.CreatePassDescriptor(p.CreateColorAttachment(new e(1657907)),p.CreateDepthStencilAttachment()),S.AddVertexBuffers(P),S.AddVertexBuffers(P),g.Add([O,k]),g.AddCamera(T),g.AddCamera(w);function R(){b=1/0,clearTimeout(y),cancelAnimationFrame(f)}function z(){y=setTimeout(()=>{let e=-_||0,n=t.RandomInt(-2,2)||1/0,r=t.RandomInt(-2,2)||1/0,i=t.RandomInt(-2,2)||1/0;A[0]=Math.PI/n,A[1]=Math.PI/r,A[2]=Math.PI/i,j[0]=Math.PI/n+_,j[1]=!isFinite(n)&&_||Math.abs(n)<2&&e,j[2]=Math.abs(n)===2&&Math.sign(n)*e,j[1]&&=j[1]+Math.PI/r,j[2]&&=j[2]+Math.PI/i,b=Date.now()},1e3)}function B(e){f=requestAnimationFrame(B),e=(Date.now()-b)/1e3;let n=t.SmoothStep(e),r=t.SmootherStep(e*2);.5<=n&&(r=(.5-(n-.5))*2,n===1&&(t.Vec3.copy(A,M),t.Vec3.copy(j,D),b=1/0,z()));{let[e,i,a]=M;C[0]=t.Lerp(e,A[0],n),C[1]=t.Lerp(i,A[1],n),C[2]=t.Lerp(a,A[2],n),O.Transform=[[0,t.Lerp(0,4,r),0],C],O.Visible=!(k.Visible=!1),g.MainCamera=w,p.Render(g,!1)}{let[e,i,a]=E,[o,s,c]=D;C[0]=t.Lerp(o,j[0],n),C[1]=t.Lerp(s,j[1],n),C[2]=t.Lerp(c,j[2],n),k.Transform=[[e,t.Lerp(i,v,r),a],C],k.Visible=!(O.Visible=!1),g.MainCamera=T,p.Render(g)}}h=new ResizeObserver(e=>{for(let n of e){let{inlineSize:e,blockSize:r}=n.contentBoxSize[0];e=e<=960&&e||e-240,p.SetCanvasSize(e,r),w.ResetLocalMatrix(),T.Bottom=r,T.Right=e,T.Near=-100,p.MultisampleTexture=I.CreateMultisampleTexture(),w.AspectRatio=p.AspectRatio,w.Position=[e/360,2,8],T.UpdateViewProjectionMatrix(),w.UpdateViewProjectionMatrix();let i=r-r/3.6,a=(e-360)/1320;_=a*.2+.1,v=i*.39;let o=a+1;O.Scaling=[o,o,o];let s=(1-(r-1e3)/-400)*36+72;k.Scaling=[s*o,s*o,s*o],t.Vec3.set(.2,_,0,D),t.Vec3.set(e-(a*250+100),i,0,E)}R(),z(),f=requestAnimationFrame(B)}),h.observe(document.body)}function v(){a.OnLost=()=>void 0,cancelAnimationFrame(f),h.disconnect(),p.Destroy(),g.Destroy(),a.Destroy(void 0,m)}export{v as destroy,_ as run};