import{a as e,c as t,d as n,f as r,i,n as a,u as o}from"./lib-dOc1RxJQ.js";import{t as s}from"./F-BKO4eRpU.js";var c=`struct Uniforms{color: vec4f,light: vec3f,normal: mat3x3f};struct VertexOutput{@location(0)normal: vec3f,@builtin(position)position: vec4f};@group(0)@binding(1)var<uniform>uniforms: Uniforms;@group(0)@binding(0)var<uniform>meshModelViewProjection: mat4x4f;@vertex fn vertex(@location(0)position: vec4f,@location(1)normal: vec3f)->VertexOutput {return VertexOutput(uniforms.normal*normal,meshModelViewProjection*position);}@fragment fn fragment(@location(0)normal: vec3f)->@location(0)vec4f {let light=dot(normalize(normal),-uniforms.light);return vec4f(uniforms.color.rgb*light,uniforms.color.a);}`;(async function(l){let u;try{u=new(await(r.Renderer(l,`Directional Lighting`)))}catch(e){alert(e)}let d=new e,f=new GUI;f.onChange(O);let p=new a,m=new t,h=new i(m,null),g=new u.Pipeline;u.CreatePassDescriptor(u.CreateColorAttachment(),u.CreateDepthStencilAttachment());let _=g.CreateShaderModule(c),v={rotation:n.DegreesToRadians(0)},{uniforms:y,buffer:b}=g.CreateUniformBuffer(`uniforms`),x={min:-360,max:360,step:1,converters:GUI.converters.radToDeg},S=[g.CreateVertexBufferLayout({name:`position`,format:`float32x3`}),g.CreateVertexBufferLayout({name:`normal`,format:`float32x3`})],{vertexData:C,normalData:w,vertices:T}=s(),E=g.CreateVertexBuffer(w);h.SetRenderPipeline(await u.AddPipeline(g,{vertex:g.CreateVertexState(_,S),depthStencil:g.CreateDepthStencilState(),fragment:g.CreateFragmentState(_),primitive:g.CreatePrimitiveState()}),b),m.CreateVertexBuffer(g,C),g.WriteBuffer(E,w),f.add(v,`rotation`,x),g.AddVertexBuffers(E),m.SetDrawParams(T);let D=n.Vec3.create(-.5,-.7,-1);y.color.set(new o(3407667).rgba),n.Vec3.normalize(D,D),y.light.set(D),d.Add(h);function O(){h.Rotation=[0,v.rotation,0];let e=n.Mat4.rotationY(v.rotation);n.Mat3.fromMat4(n.Mat4.transpose(n.Mat4.inverse(e)),y.normal),g.WriteBuffer(b,y.normal.buffer),u.Render(d)}new ResizeObserver(e=>{for(let t of e){let{inlineSize:e,blockSize:n}=t.contentBoxSize[0];u.SetCanvasSize(e,n),p.AspectRatio=u.AspectRatio,p.UpdateViewProjectionMatrix(),p.Position=[100,150,200],p.LookAt([0,35,0]),d.AddCamera(p)}O()}).observe(document.body)})(document.getElementById(`lesson`));