import{_ as e,a as t,b as n,c as r,d as i,g as a,h as o,i as s,l as c,n as l,p as u,y as d}from"./lib-DY3i1ENJ.js";import{n as f,t as p}from"./F-BudG6IPd.js";var m=class extends f{#e=o.create();#t=1;constructor(e,t=`PointLight`){super(t),this.Position=e||this.#e}set Position(e){o.copy(e,this.#e)}get Position(){return this.#e}set Intensity(e){this.#t=Math.max(e,u.EPSILON)}get Intensity(){return this.#t}},h=`struct VertexOutput{@location(0)normal: vec3f,@location(1)lightDirection: vec3f,@location(2)cameraDirection: vec3f,@builtin(position)position: vec4f};@group(0)@binding(2)var<uniform>Light: LightUniforms;@group(0)@binding(3)var<uniform>Camera: CameraUniforms;@vertex fn meshVertex(@location(0)position: vec4f,@location(1)normal: vec3f)->VertexOutput {var output: VertexOutput;output.position=GetVertexClipSpace(position);let worldPosition=GetVertexWorldPosition(position);output.lightDirection=GetLightDirection(worldPosition,Light.position);output.cameraDirection=GetCameraDirection(worldPosition,Camera.position);output.normal=GetVertexNormal(MeshUniforms.worldNormal,normal);return output;}@fragment fn meshFragment(vertex: VertexOutput)->@location(0)vec4f {let pointLightColor=GetPointLightColor(PointLight(vertex.normal,Light.intensity,vertex.lightDirection,vertex.cameraDirection),color.rgb);return vec4f(pointLightColor,color.a);}`;(async function(o){let u;try{u=new(await(a.Renderer(o,`Point Lighting`)))}catch(e){alert(e)}let f=new t,g=new GUI;g.onChange(F),u.CreatePassDescriptor(u.CreateColorAttachment(),u.CreateDepthStencilAttachment());let _=new l,v=new r,y=new u.Pipeline,b=[void 0,`meshVertex`],x=y.CreateShaderModule([d,n,e,h]),{Camera:S,buffer:C}=y.CreateUniformBuffer(`Camera`),{Light:w,buffer:T}=y.CreateUniformBuffer(`Light`),E=new s(v,new c(3407667)),D={rotation:i.DegreesToRadians(0),shininess:30},O={min:-360,max:360,step:1,converters:GUI.converters.radToDeg},k=[y.CreateVertexBufferLayout({name:`position`,format:`float32x3`},...b),y.CreateVertexBufferLayout({name:`normal`,format:`float32x3`},...b)];E.SetRenderPipeline(await u.AddPipeline(y,{fragment:y.CreateFragmentState(x,void 0,void 0,`meshFragment`),vertex:y.CreateVertexState(x,k,...b),depthStencil:y.CreateDepthStencilState(),primitive:y.CreatePrimitiveState()}),[T,C]);let{vertexData:A,normalData:j,vertices:M}=p(),N=y.CreateVertexBuffer(j);v.CreateVertexBuffer(y,A),y.WriteBuffer(N,j),y.AddVertexBuffers(N),v.SetDrawParams(M),g.add(D,`rotation`,O),g.add(D,`shininess`,{min:1,max:250});let P=new m([-10,30,100]);w.position.set(P.Position),f.Add(E);function F(){S.position.set(_.Position),w.intensity[0]=P.Intensity=D.shininess,y.WriteBuffer(T,w.position.buffer),y.WriteBuffer(C,S.position),E.Rotation=[0,D.rotation,0],u.Render(f)}new ResizeObserver(e=>{for(let t of e){let{inlineSize:e,blockSize:n}=t.contentBoxSize[0];u.SetCanvasSize(e,n),_.AspectRatio=u.AspectRatio,_.UpdateViewProjectionMatrix(),_.Position=[100,150,200],_.LookAt([0,35,0]),f.AddCamera(_)}F()}).observe(document.body)})(document.getElementById(`lesson`));