import{a as e,d as t,f as n,i as r,l as i,n as a,p as o,s,u as c}from"./lib-BpSa0Z_M.js";import{addButtonLeftJustified as l}from"https://webgpufundamentals.org/webgpu/resources/js/gui-helpers.js";var u=`struct VertexInput{@location(0)position: vec4f,@location(1)color: vec4f};struct VertexOutput{@location(0)color: vec4f,@builtin(position)position: vec4f};@vertex fn cubeVertex(input: VertexInput)->VertexOutput {return VertexOutput(input.color,GetVertexClipSpace(input.position));}@fragment fn cubeFragment(vertex: VertexOutput)->@location(0)vec4f {return vertex.color*color;}`;(async function(d){let f;d.style.backgroundColor=`#000`;try{f=new(await(n.Renderer(d,`Scene Graphs`)))}catch(e){alert(e)}let p={min:-90,max:90,step:1,converters:GUI.converters.radToDeg},ee={min:-180,max:180,step:1,converters:GUI.converters.radToDeg},m=new c(16777215),h=new i(16777215),te=new i(m.Set(8355711)),g=new i(m.Set(12566463,191)),[_,v,y]=[0,1,2],ne=new Set([0,1,2]),b=[40,30,50],x=[10,2,2],S=[],C=!1,w,T,E,D=0,O={cameraRotation:t.DegreesToRadians(-45),animate:!1,showMeshNodes:!1,showAllTransforms:!1,position:t.Vec3.create(),rotation:t.Vec3.create(),scale:t.Vec3.set(1,1,1)},k=new e,A=new GUI().onChange($);A.add(O,`cameraRotation`,ee).onChange(K),A.add(O,`animate`).onChange(e=>j.enable(!e)),A.add(O,`showMeshNodes`).onChange(Z),A.add(O,`showAllTransforms`).onChange(X);let j=A.addFolder(`Orientation`);j.onChange(()=>E.Transform=[O.position,O.rotation,O.scale]);let M=[j.add(O.position,`0`,-200,200,1).name(`Position X`),j.add(O.position,`1`,-200,200,1).name(`Position Y`),j.add(O.position,`2`,-200,200,1).name(`Position Z`),j.add(O.rotation,`0`,p).name(`Rotation X`),j.add(O.rotation,`1`,p).name(`Rotation Y`),j.add(O.rotation,`2`,p).name(`Rotation Z`),j.add(O.scale,`0`,.1,100).name(`Scale X`),j.add(O.scale,`1`,.1,100).name(`Scale Y`),j.add(O.scale,`2`,.1,100).name(`Scale Z`)],N=[0,b[v]/3*2-b[v]/2,x[y]/2+b[y]/2],P=b[_]+10,F=b[v]+3,I=[b[_]+6,F*4+6,b[y]+4],L=new a,R=new s,z=new f.Pipeline,B=(I[_]+P)/2*4/2+4,V=z.CreateShaderModule([o,u]),{layout:H,buffer:U}=J();await f.AddPipeline(z,{primitive:z.CreatePrimitiveState(),depthStencil:z.CreateDepthStencilState(),fragment:z.CreateFragmentState(V,void 0,void 0,`cubeFragment`),vertex:z.CreateVertexState(V,[R.GetPositionBufferLayout(z),H],void 0,`cubeVertex`)}),Array.from({length:5}).forEach((e,t)=>ie(k,t));let W=G(A.addFolder(`Nodes`),k);f.CreatePassDescriptor(f.CreateColorAttachment(),f.CreateDepthStencilAttachment()),Y(k.Children[0]),X(!1),Z(!1);function G(e,t,n,r){let i=[],a=r===void 0;if(t.Label!==`Scene`){let n=`${a?``:`${r}\u00a0+-`}${t.Label}`;i.push(l(e,n,()=>Y(t)))}return r=a?``:`${r}${n?`\xA0\xA0\xA0`:`\xA0|\xA0`}`,i.push(...t.Children.map((n,i)=>G(e,n,i===t.Children.length-1,r))),i.flat()}function K(e){L.Transform=[[B,20,0],[0,e,0]],L.Position=[0,0,300],L.UpdateViewProjectionMatrix()}function q(){let{Position:e,Rotation:t,Scaling:n}=E;O.position.set(e),O.rotation.set(t),O.scale.set(n),j.updateDisplay()}function J(){let e=new Uint8Array(96),t=[200,200,70,90,130,110,70,200,210,160,160,220,200,70,120,80,70,200];for(let n=0,r=0;n<24;r=(++n/4|0)*3)e.set(t.slice(r,r+3),n*4),e[n*4+3]=255;return R.AddVertexBuffer(z,e,{name:`color`,format:`unorm8x4`},void 0,`cubeVertex`)}function Y(e){E=e,j.name(`Orientation: ${e.Label}`),q()}function X(e){M.forEach((t,n)=>t.show(e||ne.has(n)))}function Z(e){for(let t of W)t.domElement.textContent.includes(`mesh`)&&t.show(e)}function Q(e,t,n,i){let a=new r(R,i,e,t);return a.SetRenderPipeline(z),z.AddVertexBuffers(U),a.Transform=n,a}function re(e,t){let n=`drawer${t}`,r=I[v]/2-b[v]/2-5,i=Q(n,e,[[0,F*t-r,3]]);S.push(i),Q(`${n}-drawer-mesh`,i,[void 0,void 0,b],h),Q(`${n}-handle-mesh`,i,[N,void 0,x],te)}function ie(e,t){let n=`cabinet${t}`,r=Q(n,e,[[t*P,0,0]]);Q(`${n}-mesh`,r,[void 0,void 0,I],g);for(let e=0;e<4;++e)re(r,e)}function $(){w||=requestAnimationFrame(oe)}function ae(){S.forEach((e,n)=>e.Position[2]=t.Lerp(3,b[2]*.8,Math.sin(D+n)*.5+.5))}function oe(){w=void 0,f.Render(k);let e=O.animate,t=performance.now()*.001,n=C&&t-T||0;T=t,C=e,e&&(D+=n),O.animate&&(ae(),q(),$())}new ResizeObserver(e=>{for(let t of e){let{inlineSize:e,blockSize:n}=t.contentBoxSize[0];f.SetCanvasSize(e,n),L.AspectRatio=f.AspectRatio,K(O.cameraRotation),k.AddCamera(L)}$()}).observe(document.body)})(document.getElementById(`lesson`));