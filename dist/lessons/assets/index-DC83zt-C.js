import{U as P,A as s,F as a}from"./index-C5aT1QyT.js";import{g as L}from"./mipmaps-kMQ0t0FP.js";import{C as l,Q as N}from"./Quad-C4zpvK4p.js";var G="struct Transform{scale: vec2f,offset: vec2f};struct VertexOutput{@builtin(position)position: vec4f,@location(0)textureCoord: vec2f};@group(0)@binding(0)var Sampler: sampler;@group(0)@binding(1)var Texture: texture_2d<f32>;@group(0)@binding(2)var<uniform>transform: Transform;@vertex fn vertex(@builtin(vertex_index)index: u32)->VertexOutput {var output: VertexOutput;var position=GetQuadCoord(index);position=(position+1)*0.5;output.position=vec4f(position*transform.scale+transform.offset,0.0,1.0);output.textureCoord=position;return output;}@fragment fn fragment(@location(0)textureCoord: vec2f)->@location(0)vec4f {return textureSample(Texture,Sampler,textureCoord);}";/**
 * @module Textures
 * @author Ustym Ukhman <ustym.ukhman@gmail.com>
 * @description This lesson is reproduced from WebGPU Textures
 * {@link https://webgpufundamentals.org/webgpu/lessons/webgpu-textures.html}&nbsp;
 * and developed by using a version listed below. Please note that this code
 * may be simplified in future thanks to more recent library APIs.
 * @version 0.0.5
 * @license MIT
 */(async function(d){let t;try{t=new(await P.RenderPipeline(d,"Texture"))}catch(r){alert(r)}const v=t.CreatePassDescriptor(t.CreateColorAttachment(void 0,"clear","store",new l(5000268).rgba)),A=t.CreateShaderModule([N,G]);t.CreatePipeline({vertex:t.CreateVertexState(A),fragment:t.CreateFragmentState(A)});const B=5,w=0,F=2,o={addressModeU:s.REPEAT,addressModeV:s.REPEAT,magFilter:a.LINEAR,minFilter:a.LINEAR,scale:1},x=[s.REPEAT,s.CLAMP],g=[a.NEAREST,a.LINEAR],u=new GUI;u.add(o,"addressModeU",x),u.add(o,"addressModeV",x),u.add(o,"magFilter",g),u.add(o,"minFilter",g),u.add(o,"scale",.5,6);const e=new l(16711680).RGBA,i=new l(16776960).RGBA,M=new l(255).RGBA,U=new Uint8Array([e,e,e,e,e,e,i,e,e,e,e,i,e,e,e,e,i,i,e,e,e,i,e,e,e,e,i,i,i,e,M,e,e,e,e].flat()),c=L(U,B),m=new(await P.Texture()),T=m.CreateTexture({usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST,size:[c[0].width,c[0].height],mipLevelCount:c.length,format:"rgba8unorm"});c.forEach(({data:r,width:n,height:f},p)=>m.WriteTexture(r,{bytesPerRow:n*4,texture:T,mipLevel:p,width:n,height:f}));const R=2*Float32Array.BYTES_PER_ELEMENT+2*Float32Array.BYTES_PER_ELEMENT,C=t.CreateBuffer({size:R,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),E=new Float32Array(R/Float32Array.BYTES_PER_ELEMENT);for(let r=0;r<16;r++){const n=m.CreateSampler({addressModeU:r&1?s.REPEAT:s.CLAMP,addressModeV:r&2?s.REPEAT:s.CLAMP,magFilter:r&4?a.LINEAR:a.NEAREST,minFilter:r&8?a.LINEAR:a.NEAREST});t.AddBindGroups(t.CreateBindGroup(t.CreateBindGroupEntries([n,T.createView(),{buffer:C}])))}function b(r){const n=4/d.width*o.scale,f=4/d.height*o.scale;E.set([n,f],w),E.set([Math.sin(r*.25)*.8,-.8],F),t.WriteBuffer(C,E)}function S(r){v.colorAttachments[0].view=t.CurrentTextureView;const n=+(o.addressModeU===s.REPEAT)*1+ +(o.addressModeV===s.REPEAT)*2+ +(o.magFilter===a.LINEAR)*4+ +(o.minFilter===a.LINEAR)*8;t.SetActiveBindGroups(n),b(r*.001),t.Render(6),requestAnimationFrame(S)}new ResizeObserver(r=>{for(const n of r){const{inlineSize:f,blockSize:p}=n.contentBoxSize[0];t.SetCanvasSize(f/64|0,p/64|0)}requestAnimationFrame(S)}).observe(d),d.style.imageRendering="pixelated",d.style.imageRendering="crisp-edges"})(document.getElementById("lesson"));
