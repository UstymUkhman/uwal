import{_ as e,a as t,b as n,d as r,g as i,h as a,i as o,l as s,n as c,p as l,s as u,y as d}from"./lib-CmpeTGut.js";import{n as f,t as p}from"./F-B-w0IlMC.js";var m=class extends f{#e=a.create();#t=1;constructor(e,t=`PointLight`){super(t),this.Position=e||this.#e}set Position(e){a.copy(e,this.#e)}get Position(){return this.#e}set Intensity(e){this.#t=Math.max(e,l.EPSILON)}get Intensity(){return this.#t}},h=`struct VertexOutput{@location(0)normal: vec3f,@location(1)lightDirection: vec3f,@location(2)cameraDirection: vec3f,@builtin(position)position: vec4f};@group(0)@binding(2)var<uniform>Light: LightUniforms;@group(0)@binding(3)var<uniform>Camera: CameraUniforms;@vertex fn meshVertex(@location(0)position: vec4f,@location(1)normal: vec3f)->VertexOutput {var output: VertexOutput;output.position=GetVertexClipSpace(position);let worldPosition=GetVertexWorldPosition(position);output.lightDirection=GetLightDirection(worldPosition,Light.position);output.cameraDirection=GetCameraDirection(worldPosition,Camera.position);output.normal=GetVertexNormal(MeshUniforms.worldNormal,normal);return output;}@fragment fn meshFragment(vertex: VertexOutput)->@location(0)vec4f {let pointLightColor=GetPointLightColor(PointLight(vertex.normal,Light.intensity,vertex.lightDirection,vertex.cameraDirection),color.rgb);return vec4f(pointLightColor,color.a);}`;(async function(a){let l;try{l=new(await(i.Renderer(a,`Point Lighting`)))}catch(e){alert(e)}let f=new t,g=new GUI;g.onChange(P);let _=new c,v=new u,y=new l.Pipeline,b=y.CreateShaderModule([d,n,e,h]),{Camera:x,buffer:S}=y.CreateUniformBuffer(`Camera`),{Light:C,buffer:w}=y.CreateUniformBuffer(`Light`),T=new o(v,new s(3407667)),E={rotation:r.DegreesToRadians(0),shininess:30},D={min:-360,max:360,step:1,converters:GUI.converters.radToDeg},O=[y.CreateVertexBufferLayout({name:`position`,format:`float32x3`},`meshVertex`),y.CreateVertexBufferLayout({name:`normal`,format:`float32x3`},`meshVertex`)];T.SetRenderPipeline(await l.AddPipeline(y,{vertex:y.CreateVertexState(b,O,`meshVertex`),fragment:y.CreateFragmentState(b,void 0,`meshFragment`),depthStencil:y.CreateDepthStencilState(),primitive:y.CreatePrimitiveState()}),[w,S]);let{positionData:k,normalData:A,vertices:j}=p(),M=y.CreateVertexBuffer(A);v.CreatePositionBuffer(y,k),y.WriteBuffer(M,A),y.AddVertexBuffers(M),v.SetDrawParams(j),g.add(E,`rotation`,D),g.add(E,`shininess`,{min:1,max:250});let N=new m([-10,30,100]);C.position.set(N.Position),f.Add(T);function P(){x.position.set(_.Position),C.intensity[0]=N.Intensity=E.shininess,y.WriteBuffer(w,C.position.buffer),y.WriteBuffer(S,x.position),T.Rotation=[0,E.rotation,0],l.Render(f)}new ResizeObserver(e=>{for(let t of e){let{inlineSize:e,blockSize:n}=t.contentBoxSize[0];l.SetCanvasSize(e,n),_.AspectRatio=l.AspectRatio,_.UpdateViewProjectionMatrix(),_.Position=[100,150,200],_.LookAt([0,35,0]),f.AddCamera(_)}P()}).observe(document.body)})(document.getElementById(`lesson`));