import{_ as e,a as t,b as n,d as r,g as i,h as a,i as o,l as s,n as c,s as l,y as u}from"./lib-1rS3DT50.js";import{n as d,t as f}from"./F-CzTbXAUa.js";var p=class extends d{#e=a.create();constructor(e,t=`PointLight`){super(t),this.Position=e||this.#e}set Position(e){a.copy(e,this.#e)}get Position(){return this.#e}},m=`struct VertexOutput{@location(0)normal: vec3f,@location(1)lightDirection: vec3f,@location(2)cameraDirection: vec3f,@builtin(position)position: vec4f};@group(0)@binding(2)var<uniform>Light: LightUniforms;@group(0)@binding(3)var<uniform>Camera: CameraUniforms;@vertex fn meshVertex(@location(0)position: vec4f,@location(1)normal: vec3f)->VertexOutput {var output: VertexOutput;output.position=GetVertexClipSpace(position);let worldPosition=GetVertexWorldPosition(position);output.lightDirection=GetLightDirection(worldPosition,Light.position);output.cameraDirection=GetCameraDirection(worldPosition,Camera.position);output.normal=GetVertexNormal(MeshUniforms.worldNormal,normal);return output;}@fragment fn meshFragment(vertex: VertexOutput)->@location(0)vec4f {let pointLight=GetPointLight(PointLight(vertex.normal,Light.intensity,vertex.lightDirection,vertex.cameraDirection));return vec4f(color.rgb*pointLight.value+pointLight.specular,color.a);}`;(async function(a){let d;try{d=new(await(i.Renderer(a,`Point Lighting`)))}catch(e){alert(e)}let h=new t,g=new GUI;g.onChange(P);let _=new c,v=new l,y=new d.Pipeline,b=y.CreateShaderModule([u,n,e,m]),{Camera:x,buffer:S}=y.CreateUniformBuffer(`Camera`),{Light:C,buffer:w}=y.CreateUniformBuffer(`Light`),T=new o(v,new s(3407667)),E={rotation:r.DegreesToRadians(0),shininess:30},D={min:-360,max:360,step:1,converters:GUI.converters.radToDeg},O=[y.CreateVertexBufferLayout({name:`position`,format:`float32x3`},`meshVertex`),y.CreateVertexBufferLayout({name:`normal`,format:`float32x3`},`meshVertex`)];T.SetRenderPipeline(await d.AddPipeline(y,{vertex:y.CreateVertexState(b,O,`meshVertex`),fragment:y.CreateFragmentState(b,void 0,`meshFragment`),depthStencil:y.CreateDepthStencilState(),primitive:y.CreatePrimitiveState()}),[w,S]);let{positionData:k,normalData:A,vertices:j}=f(),M=y.CreateVertexBuffer(A);v.CreatePositionBuffer(y,k),y.WriteBuffer(M,A),y.AddVertexBuffers(M),v.SetDrawParams(j),g.add(E,`rotation`,D),g.add(E,`shininess`,{min:1,max:250});let N=new p([-10,30,100]);C.position.set(N.Position),h.Add(T);function P(){x.position.set(_.Position),C.intensity[0]=N.Intensity=E.shininess,y.WriteBuffer(w,C.position.buffer),y.WriteBuffer(S,x.position),T.Rotation=[0,E.rotation,0],d.Render(h)}new ResizeObserver(e=>{for(let t of e){let{inlineSize:e,blockSize:n}=t.contentBoxSize[0];d.SetCanvasSize(e,n),_.AspectRatio=d.AspectRatio,_.UpdateViewProjectionMatrix(),_.Position=[100,150,200],_.LookAt([0,35,0]),h.AddCamera(_)}P()}).observe(document.body)})(document.getElementById(`lesson`));