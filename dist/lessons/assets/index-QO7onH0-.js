import{c as Fn,a as Rn}from"./mipmaps-kMQ0t0FP.js";import{U as pn,A as Mn,F as W}from"./index-C5aT1QyT.js";import{C as Vn,Q as Un}from"./Quad-C4zpvK4p.js";let G=1e-6,T=Float32Array;function Gn(o){const n=T;return T=o,n}function hn(o=0,n=0){const e=new T(2);return o!==void 0&&(e[0]=o,n!==void 0&&(e[1]=n)),e}let H=Float32Array;function j(o,n,e){const c=new H(3);return o!==void 0&&(c[0]=o,n!==void 0&&(c[1]=n,e!==void 0&&(c[2]=e))),c}const In=hn;function Ln(o,n,e){return e=e||new T(2),e[0]=o,e[1]=n,e}function On(o,n){return n=n||new T(2),n[0]=Math.ceil(o[0]),n[1]=Math.ceil(o[1]),n}function Dn(o,n){return n=n||new T(2),n[0]=Math.floor(o[0]),n[1]=Math.floor(o[1]),n}function Nn(o,n){return n=n||new T(2),n[0]=Math.round(o[0]),n[1]=Math.round(o[1]),n}function Yn(o,n=0,e=1,c){return c=c||new T(2),c[0]=Math.min(e,Math.max(n,o[0])),c[1]=Math.min(e,Math.max(n,o[1])),c}function Xn(o,n,e){return e=e||new T(2),e[0]=o[0]+n[0],e[1]=o[1]+n[1],e}function jn(o,n,e,c){return c=c||new T(2),c[0]=o[0]+n[0]*e,c[1]=o[1]+n[1]*e,c}function kn(o,n){const e=o[0],c=o[1],r=o[0],u=o[1],i=Math.sqrt(e*e+c*c),l=Math.sqrt(r*r+u*u),p=i*l,h=p&&yn(o,n)/p;return Math.acos(h)}function wn(o,n,e){return e=e||new T(2),e[0]=o[0]-n[0],e[1]=o[1]-n[1],e}const Qn=wn;function Wn(o,n){return Math.abs(o[0]-n[0])<G&&Math.abs(o[1]-n[1])<G}function Zn(o,n){return o[0]===n[0]&&o[1]===n[1]}function xn(o,n,e,c){return c=c||new T(2),c[0]=o[0]+e*(n[0]-o[0]),c[1]=o[1]+e*(n[1]-o[1]),c}function Hn(o,n,e,c){return c=c||new T(2),c[0]=o[0]+e[0]*(n[0]-o[0]),c[1]=o[1]+e[1]*(n[1]-o[1]),c}function Jn(o,n,e){return e=e||new T(2),e[0]=Math.max(o[0],n[0]),e[1]=Math.max(o[1],n[1]),e}function Kn(o,n,e){return e=e||new T(2),e[0]=Math.min(o[0],n[0]),e[1]=Math.min(o[1],n[1]),e}function on(o,n,e){return e=e||new T(2),e[0]=o[0]*n,e[1]=o[1]*n,e}const mn=on;function bn(o,n,e){return e=e||new T(2),e[0]=o[0]/n,e[1]=o[1]/n,e}function $n(o,n){return n=n||new T(2),n[0]=1/o[0],n[1]=1/o[1],n}const sn=$n;function dn(o,n,e){e=e||new H(3);const c=o[0]*n[1]-o[1]*n[0];return e[0]=0,e[1]=0,e[2]=c,e}function yn(o,n){return o[0]*n[0]+o[1]*n[1]}function en(o){const n=o[0],e=o[1];return Math.sqrt(n*n+e*e)}const n1=en;function An(o){const n=o[0],e=o[1];return n*n+e*e}const o1=An;function Sn(o,n){const e=o[0]-n[0],c=o[1]-n[1];return Math.sqrt(e*e+c*c)}const e1=Sn;function gn(o,n){const e=o[0]-n[0],c=o[1]-n[1];return e*e+c*c}const c1=gn;function Tn(o,n){n=n||new T(2);const e=o[0],c=o[1],r=Math.sqrt(e*e+c*c);return r>1e-5?(n[0]=e/r,n[1]=c/r):(n[0]=0,n[1]=0),n}function r1(o,n){return n=n||new T(2),n[0]=-o[0],n[1]=-o[1],n}function cn(o,n){return n=n||new T(2),n[0]=o[0],n[1]=o[1],n}const i1=cn;function En(o,n,e){return e=e||new T(2),e[0]=o[0]*n[0],e[1]=o[1]*n[1],e}const u1=En;function zn(o,n,e){return e=e||new T(2),e[0]=o[0]/n[0],e[1]=o[1]/n[1],e}const t1=zn;function a1(o=1,n){n=n||new T(2);const e=Math.random()*2*Math.PI;return n[0]=Math.cos(e)*o,n[1]=Math.sin(e)*o,n}function f1(o){return o=o||new T(2),o[0]=0,o[1]=0,o}function l1(o,n,e){e=e||new T(2);const c=o[0],r=o[1];return e[0]=c*n[0]+r*n[4]+n[12],e[1]=c*n[1]+r*n[5]+n[13],e}function p1(o,n,e){e=e||new T(2);const c=o[0],r=o[1];return e[0]=n[0]*c+n[4]*r+n[8],e[1]=n[1]*c+n[5]*r+n[9],e}function M1(o,n,e,c){c=c||new T(2);const r=o[0]-n[0],u=o[1]-n[1],i=Math.sin(e),l=Math.cos(e);return c[0]=r*l-u*i+n[0],c[1]=r*i+u*l+n[1],c}function Cn(o,n,e){return e=e||new T(2),Tn(o,e),on(e,n,e)}function h1(o,n,e){return e=e||new T(2),en(o)>n?Cn(o,n,e):cn(o,e)}function w1(o,n,e){return e=e||new T(2),xn(o,n,.5,e)}var x1=Object.freeze({__proto__:null,add:Xn,addScaled:jn,angle:kn,ceil:On,clamp:Yn,clone:i1,copy:cn,create:hn,cross:dn,dist:e1,distSq:c1,distance:Sn,distanceSq:gn,div:t1,divScalar:bn,divide:zn,dot:yn,equals:Zn,equalsApproximately:Wn,floor:Dn,fromValues:In,inverse:$n,invert:sn,len:n1,lenSq:o1,length:en,lengthSq:An,lerp:xn,lerpV:Hn,max:Jn,midpoint:w1,min:Kn,mul:u1,mulScalar:on,multiply:En,negate:r1,normalize:Tn,random:a1,rotate:M1,round:Nn,scale:mn,set:Ln,setDefaultType:Gn,setLength:Cn,sub:Qn,subtract:wn,transformMat3:p1,transformMat4:l1,truncate:h1,zero:f1});const $1=new Map([[Float32Array,()=>new Float32Array(12)],[Float64Array,()=>new Float64Array(12)],[Array,()=>new Array(12).fill(0)]]);$1.get(Float32Array);function rn(o,n,e){return e=e||new H(3),e[0]=o[0]-n[0],e[1]=o[1]-n[1],e[2]=o[2]-n[2],e}function Z(o,n,e){e=e||new H(3);const c=o[2]*n[0]-o[0]*n[2],r=o[0]*n[1]-o[1]*n[0];return e[0]=o[1]*n[2]-o[2]*n[1],e[1]=c,e[2]=r,e}function Q(o,n){n=n||new H(3);const e=o[0],c=o[1],r=o[2],u=Math.sqrt(e*e+c*c+r*r);return u>1e-5?(n[0]=e/u,n[1]=c/u,n[2]=r/u):(n[0]=0,n[1]=0,n[2]=0),n}let g=Float32Array;function y1(o){const n=g;return g=o,n}function A1(o,n,e,c,r,u,i,l,p,h,M,f,t,$,w,y){const a=new g(16);return o!==void 0&&(a[0]=o,n!==void 0&&(a[1]=n,e!==void 0&&(a[2]=e,c!==void 0&&(a[3]=c,r!==void 0&&(a[4]=r,u!==void 0&&(a[5]=u,i!==void 0&&(a[6]=i,l!==void 0&&(a[7]=l,p!==void 0&&(a[8]=p,h!==void 0&&(a[9]=h,M!==void 0&&(a[10]=M,f!==void 0&&(a[11]=f,t!==void 0&&(a[12]=t,$!==void 0&&(a[13]=$,w!==void 0&&(a[14]=w,y!==void 0&&(a[15]=y)))))))))))))))),a}function S1(o,n,e,c,r,u,i,l,p,h,M,f,t,$,w,y,a){return a=a||new g(16),a[0]=o,a[1]=n,a[2]=e,a[3]=c,a[4]=r,a[5]=u,a[6]=i,a[7]=l,a[8]=p,a[9]=h,a[10]=M,a[11]=f,a[12]=t,a[13]=$,a[14]=w,a[15]=y,a}function g1(o,n){return n=n||new g(16),n[0]=o[0],n[1]=o[1],n[2]=o[2],n[3]=0,n[4]=o[4],n[5]=o[5],n[6]=o[6],n[7]=0,n[8]=o[8],n[9]=o[9],n[10]=o[10],n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function T1(o,n){n=n||new g(16);const e=o[0],c=o[1],r=o[2],u=o[3],i=e+e,l=c+c,p=r+r,h=e*i,M=c*i,f=c*l,t=r*i,$=r*l,w=r*p,y=u*i,a=u*l,S=u*p;return n[0]=1-f-w,n[1]=M+S,n[2]=t-a,n[3]=0,n[4]=M-S,n[5]=1-h-w,n[6]=$+y,n[7]=0,n[8]=t+a,n[9]=$-y,n[10]=1-h-f,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function E1(o,n){return n=n||new g(16),n[0]=-o[0],n[1]=-o[1],n[2]=-o[2],n[3]=-o[3],n[4]=-o[4],n[5]=-o[5],n[6]=-o[6],n[7]=-o[7],n[8]=-o[8],n[9]=-o[9],n[10]=-o[10],n[11]=-o[11],n[12]=-o[12],n[13]=-o[13],n[14]=-o[14],n[15]=-o[15],n}function un(o,n){return n=n||new g(16),n[0]=o[0],n[1]=o[1],n[2]=o[2],n[3]=o[3],n[4]=o[4],n[5]=o[5],n[6]=o[6],n[7]=o[7],n[8]=o[8],n[9]=o[9],n[10]=o[10],n[11]=o[11],n[12]=o[12],n[13]=o[13],n[14]=o[14],n[15]=o[15],n}const z1=un;function C1(o,n){return Math.abs(o[0]-n[0])<G&&Math.abs(o[1]-n[1])<G&&Math.abs(o[2]-n[2])<G&&Math.abs(o[3]-n[3])<G&&Math.abs(o[4]-n[4])<G&&Math.abs(o[5]-n[5])<G&&Math.abs(o[6]-n[6])<G&&Math.abs(o[7]-n[7])<G&&Math.abs(o[8]-n[8])<G&&Math.abs(o[9]-n[9])<G&&Math.abs(o[10]-n[10])<G&&Math.abs(o[11]-n[11])<G&&Math.abs(o[12]-n[12])<G&&Math.abs(o[13]-n[13])<G&&Math.abs(o[14]-n[14])<G&&Math.abs(o[15]-n[15])<G}function q1(o,n){return o[0]===n[0]&&o[1]===n[1]&&o[2]===n[2]&&o[3]===n[3]&&o[4]===n[4]&&o[5]===n[5]&&o[6]===n[6]&&o[7]===n[7]&&o[8]===n[8]&&o[9]===n[9]&&o[10]===n[10]&&o[11]===n[11]&&o[12]===n[12]&&o[13]===n[13]&&o[14]===n[14]&&o[15]===n[15]}function qn(o){return o=o||new g(16),o[0]=1,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=1,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=1,o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o}function v1(o,n){if(n=n||new g(16),n===o){let A;return A=o[1],o[1]=o[4],o[4]=A,A=o[2],o[2]=o[8],o[8]=A,A=o[3],o[3]=o[12],o[12]=A,A=o[6],o[6]=o[9],o[9]=A,A=o[7],o[7]=o[13],o[13]=A,A=o[11],o[11]=o[14],o[14]=A,n}const e=o[0*4+0],c=o[0*4+1],r=o[0*4+2],u=o[0*4+3],i=o[1*4+0],l=o[1*4+1],p=o[1*4+2],h=o[1*4+3],M=o[2*4+0],f=o[2*4+1],t=o[2*4+2],$=o[2*4+3],w=o[3*4+0],y=o[3*4+1],a=o[3*4+2],S=o[3*4+3];return n[0]=e,n[1]=i,n[2]=M,n[3]=w,n[4]=c,n[5]=l,n[6]=f,n[7]=y,n[8]=r,n[9]=p,n[10]=t,n[11]=a,n[12]=u,n[13]=h,n[14]=$,n[15]=S,n}function vn(o,n){n=n||new g(16);const e=o[0*4+0],c=o[0*4+1],r=o[0*4+2],u=o[0*4+3],i=o[1*4+0],l=o[1*4+1],p=o[1*4+2],h=o[1*4+3],M=o[2*4+0],f=o[2*4+1],t=o[2*4+2],$=o[2*4+3],w=o[3*4+0],y=o[3*4+1],a=o[3*4+2],S=o[3*4+3],A=t*S,B=a*$,F=p*S,U=a*h,x=p*$,v=t*h,q=r*S,z=a*u,_=r*$,R=t*u,V=r*h,I=p*u,O=M*y,D=w*f,N=i*y,Y=w*l,X=i*f,J=M*l,K=e*y,m=w*c,b=e*f,s=M*c,d=e*l,nn=i*c,tn=A*l+U*f+x*y-(B*l+F*f+v*y),an=B*c+q*f+R*y-(A*c+z*f+_*y),fn=F*c+z*l+V*y-(U*c+q*l+I*y),ln=v*c+_*l+I*f-(x*c+R*l+V*f),L=1/(e*tn+i*an+M*fn+w*ln);return n[0]=L*tn,n[1]=L*an,n[2]=L*fn,n[3]=L*ln,n[4]=L*(B*i+F*M+v*w-(A*i+U*M+x*w)),n[5]=L*(A*e+z*M+_*w-(B*e+q*M+R*w)),n[6]=L*(U*e+q*i+I*w-(F*e+z*i+V*w)),n[7]=L*(x*e+R*i+V*M-(v*e+_*i+I*M)),n[8]=L*(O*h+Y*$+X*S-(D*h+N*$+J*S)),n[9]=L*(D*u+K*$+s*S-(O*u+m*$+b*S)),n[10]=L*(N*u+m*h+d*S-(Y*u+K*h+nn*S)),n[11]=L*(J*u+b*h+nn*$-(X*u+s*h+d*$)),n[12]=L*(N*t+J*a+D*p-(X*a+O*p+Y*t)),n[13]=L*(b*a+O*r+m*t-(K*t+s*a+D*r)),n[14]=L*(K*p+nn*a+Y*r-(d*a+N*r+m*p)),n[15]=L*(d*t+X*r+s*p-(b*p+nn*t+J*r)),n}function P1(o){const n=o[0],e=o[0*4+1],c=o[0*4+2],r=o[0*4+3],u=o[1*4+0],i=o[1*4+1],l=o[1*4+2],p=o[1*4+3],h=o[2*4+0],M=o[2*4+1],f=o[2*4+2],t=o[2*4+3],$=o[3*4+0],w=o[3*4+1],y=o[3*4+2],a=o[3*4+3],S=f*a,A=y*t,B=l*a,F=y*p,U=l*t,x=f*p,v=c*a,q=y*r,z=c*t,_=f*r,R=c*p,V=l*r,I=S*i+F*M+U*w-(A*i+B*M+x*w),O=A*e+v*M+_*w-(S*e+q*M+z*w),D=B*e+q*i+R*w-(F*e+v*i+V*w),N=x*e+z*i+V*M-(U*e+_*i+R*M);return n*I+u*O+h*D+$*N}const _1=vn;function Pn(o,n,e){e=e||new g(16);const c=o[0],r=o[1],u=o[2],i=o[3],l=o[4],p=o[5],h=o[6],M=o[7],f=o[8],t=o[9],$=o[10],w=o[11],y=o[12],a=o[13],S=o[14],A=o[15],B=n[0],F=n[1],U=n[2],x=n[3],v=n[4],q=n[5],z=n[6],_=n[7],R=n[8],V=n[9],I=n[10],O=n[11],D=n[12],N=n[13],Y=n[14],X=n[15];return e[0]=c*B+l*F+f*U+y*x,e[1]=r*B+p*F+t*U+a*x,e[2]=u*B+h*F+$*U+S*x,e[3]=i*B+M*F+w*U+A*x,e[4]=c*v+l*q+f*z+y*_,e[5]=r*v+p*q+t*z+a*_,e[6]=u*v+h*q+$*z+S*_,e[7]=i*v+M*q+w*z+A*_,e[8]=c*R+l*V+f*I+y*O,e[9]=r*R+p*V+t*I+a*O,e[10]=u*R+h*V+$*I+S*O,e[11]=i*R+M*V+w*I+A*O,e[12]=c*D+l*N+f*Y+y*X,e[13]=r*D+p*N+t*Y+a*X,e[14]=u*D+h*N+$*Y+S*X,e[15]=i*D+M*N+w*Y+A*X,e}const B1=Pn;function F1(o,n,e){return e=e||qn(),o!==e&&(e[0]=o[0],e[1]=o[1],e[2]=o[2],e[3]=o[3],e[4]=o[4],e[5]=o[5],e[6]=o[6],e[7]=o[7],e[8]=o[8],e[9]=o[9],e[10]=o[10],e[11]=o[11]),e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e}function R1(o,n){return n=n||j(),n[0]=o[12],n[1]=o[13],n[2]=o[14],n}function V1(o,n,e){e=e||j();const c=n*4;return e[0]=o[c+0],e[1]=o[c+1],e[2]=o[c+2],e}function U1(o,n,e,c){c!==o&&(c=un(o,c));const r=e*4;return c[r+0]=n[0],c[r+1]=n[1],c[r+2]=n[2],c}function G1(o,n){n=n||j();const e=o[0],c=o[1],r=o[2],u=o[4],i=o[5],l=o[6],p=o[8],h=o[9],M=o[10];return n[0]=Math.sqrt(e*e+c*c+r*r),n[1]=Math.sqrt(u*u+i*i+l*l),n[2]=Math.sqrt(p*p+h*h+M*M),n}function I1(o,n,e,c,r){r=r||new g(16);const u=Math.tan(Math.PI*.5-.5*o);if(r[0]=u/n,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=u,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,c===1/0)r[10]=-1,r[14]=-e;else{const i=1/(e-c);r[10]=c*i,r[14]=c*e*i}return r}function L1(o,n,e,c,r,u,i){return i=i||new g(16),i[0]=2/(n-o),i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=2/(c-e),i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1/(r-u),i[11]=0,i[12]=(n+o)/(o-n),i[13]=(c+e)/(e-c),i[14]=r/(r-u),i[15]=1,i}function O1(o,n,e,c,r,u,i){i=i||new g(16);const l=n-o,p=c-e,h=r-u;return i[0]=2*r/l,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=2*r/p,i[6]=0,i[7]=0,i[8]=(o+n)/l,i[9]=(c+e)/p,i[10]=u/h,i[11]=-1,i[12]=0,i[13]=0,i[14]=r*u/h,i[15]=0,i}let C,P,E;function D1(o,n,e,c){return c=c||new g(16),C=C||j(),P=P||j(),E=E||j(),Q(rn(n,o,E),E),Q(Z(e,E,C),C),Q(Z(E,C,P),P),c[0]=C[0],c[1]=C[1],c[2]=C[2],c[3]=0,c[4]=P[0],c[5]=P[1],c[6]=P[2],c[7]=0,c[8]=E[0],c[9]=E[1],c[10]=E[2],c[11]=0,c[12]=o[0],c[13]=o[1],c[14]=o[2],c[15]=1,c}function N1(o,n,e,c){return c=c||new g(16),C=C||j(),P=P||j(),E=E||j(),Q(rn(o,n,E),E),Q(Z(e,E,C),C),Q(Z(E,C,P),P),c[0]=C[0],c[1]=C[1],c[2]=C[2],c[3]=0,c[4]=P[0],c[5]=P[1],c[6]=P[2],c[7]=0,c[8]=E[0],c[9]=E[1],c[10]=E[2],c[11]=0,c[12]=o[0],c[13]=o[1],c[14]=o[2],c[15]=1,c}function Y1(o,n,e,c){return c=c||new g(16),C=C||j(),P=P||j(),E=E||j(),Q(rn(o,n,E),E),Q(Z(e,E,C),C),Q(Z(E,C,P),P),c[0]=C[0],c[1]=P[0],c[2]=E[0],c[3]=0,c[4]=C[1],c[5]=P[1],c[6]=E[1],c[7]=0,c[8]=C[2],c[9]=P[2],c[10]=E[2],c[11]=0,c[12]=-(C[0]*o[0]+C[1]*o[1]+C[2]*o[2]),c[13]=-(P[0]*o[0]+P[1]*o[1]+P[2]*o[2]),c[14]=-(E[0]*o[0]+E[1]*o[1]+E[2]*o[2]),c[15]=1,c}function X1(o,n){return n=n||new g(16),n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=o[0],n[13]=o[1],n[14]=o[2],n[15]=1,n}function j1(o,n,e){e=e||new g(16);const c=n[0],r=n[1],u=n[2],i=o[0],l=o[1],p=o[2],h=o[3],M=o[1*4+0],f=o[1*4+1],t=o[1*4+2],$=o[1*4+3],w=o[2*4+0],y=o[2*4+1],a=o[2*4+2],S=o[2*4+3],A=o[3*4+0],B=o[3*4+1],F=o[3*4+2],U=o[3*4+3];return o!==e&&(e[0]=i,e[1]=l,e[2]=p,e[3]=h,e[4]=M,e[5]=f,e[6]=t,e[7]=$,e[8]=w,e[9]=y,e[10]=a,e[11]=S),e[12]=i*c+M*r+w*u+A,e[13]=l*c+f*r+y*u+B,e[14]=p*c+t*r+a*u+F,e[15]=h*c+$*r+S*u+U,e}function k1(o,n){n=n||new g(16);const e=Math.cos(o),c=Math.sin(o);return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=e,n[6]=c,n[7]=0,n[8]=0,n[9]=-c,n[10]=e,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function Q1(o,n,e){e=e||new g(16);const c=o[4],r=o[5],u=o[6],i=o[7],l=o[8],p=o[9],h=o[10],M=o[11],f=Math.cos(n),t=Math.sin(n);return e[4]=f*c+t*l,e[5]=f*r+t*p,e[6]=f*u+t*h,e[7]=f*i+t*M,e[8]=f*l-t*c,e[9]=f*p-t*r,e[10]=f*h-t*u,e[11]=f*M-t*i,o!==e&&(e[0]=o[0],e[1]=o[1],e[2]=o[2],e[3]=o[3],e[12]=o[12],e[13]=o[13],e[14]=o[14],e[15]=o[15]),e}function W1(o,n){n=n||new g(16);const e=Math.cos(o),c=Math.sin(o);return n[0]=e,n[1]=0,n[2]=-c,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=c,n[9]=0,n[10]=e,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function Z1(o,n,e){e=e||new g(16);const c=o[0*4+0],r=o[0*4+1],u=o[0*4+2],i=o[0*4+3],l=o[2*4+0],p=o[2*4+1],h=o[2*4+2],M=o[2*4+3],f=Math.cos(n),t=Math.sin(n);return e[0]=f*c-t*l,e[1]=f*r-t*p,e[2]=f*u-t*h,e[3]=f*i-t*M,e[8]=f*l+t*c,e[9]=f*p+t*r,e[10]=f*h+t*u,e[11]=f*M+t*i,o!==e&&(e[4]=o[4],e[5]=o[5],e[6]=o[6],e[7]=o[7],e[12]=o[12],e[13]=o[13],e[14]=o[14],e[15]=o[15]),e}function H1(o,n){n=n||new g(16);const e=Math.cos(o),c=Math.sin(o);return n[0]=e,n[1]=c,n[2]=0,n[3]=0,n[4]=-c,n[5]=e,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function J1(o,n,e){e=e||new g(16);const c=o[0*4+0],r=o[0*4+1],u=o[0*4+2],i=o[0*4+3],l=o[1*4+0],p=o[1*4+1],h=o[1*4+2],M=o[1*4+3],f=Math.cos(n),t=Math.sin(n);return e[0]=f*c+t*l,e[1]=f*r+t*p,e[2]=f*u+t*h,e[3]=f*i+t*M,e[4]=f*l-t*c,e[5]=f*p-t*r,e[6]=f*h-t*u,e[7]=f*M-t*i,o!==e&&(e[8]=o[8],e[9]=o[9],e[10]=o[10],e[11]=o[11],e[12]=o[12],e[13]=o[13],e[14]=o[14],e[15]=o[15]),e}function _n(o,n,e){e=e||new g(16);let c=o[0],r=o[1],u=o[2];const i=Math.sqrt(c*c+r*r+u*u);c/=i,r/=i,u/=i;const l=c*c,p=r*r,h=u*u,M=Math.cos(n),f=Math.sin(n),t=1-M;return e[0]=l+(1-l)*M,e[1]=c*r*t+u*f,e[2]=c*u*t-r*f,e[3]=0,e[4]=c*r*t-u*f,e[5]=p+(1-p)*M,e[6]=r*u*t+c*f,e[7]=0,e[8]=c*u*t+r*f,e[9]=r*u*t-c*f,e[10]=h+(1-h)*M,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}const K1=_n;function Bn(o,n,e,c){c=c||new g(16);let r=n[0],u=n[1],i=n[2];const l=Math.sqrt(r*r+u*u+i*i);r/=l,u/=l,i/=l;const p=r*r,h=u*u,M=i*i,f=Math.cos(e),t=Math.sin(e),$=1-f,w=p+(1-p)*f,y=r*u*$+i*t,a=r*i*$-u*t,S=r*u*$-i*t,A=h+(1-h)*f,B=u*i*$+r*t,F=r*i*$+u*t,U=u*i*$-r*t,x=M+(1-M)*f,v=o[0],q=o[1],z=o[2],_=o[3],R=o[4],V=o[5],I=o[6],O=o[7],D=o[8],N=o[9],Y=o[10],X=o[11];return c[0]=w*v+y*R+a*D,c[1]=w*q+y*V+a*N,c[2]=w*z+y*I+a*Y,c[3]=w*_+y*O+a*X,c[4]=S*v+A*R+B*D,c[5]=S*q+A*V+B*N,c[6]=S*z+A*I+B*Y,c[7]=S*_+A*O+B*X,c[8]=F*v+U*R+x*D,c[9]=F*q+U*V+x*N,c[10]=F*z+U*I+x*Y,c[11]=F*_+U*O+x*X,o!==c&&(c[12]=o[12],c[13]=o[13],c[14]=o[14],c[15]=o[15]),c}const m1=Bn;function b1(o,n){return n=n||new g(16),n[0]=o[0],n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=o[1],n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=o[2],n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function s1(o,n,e){e=e||new g(16);const c=n[0],r=n[1],u=n[2];return e[0]=c*o[0*4+0],e[1]=c*o[0*4+1],e[2]=c*o[0*4+2],e[3]=c*o[0*4+3],e[4]=r*o[1*4+0],e[5]=r*o[1*4+1],e[6]=r*o[1*4+2],e[7]=r*o[1*4+3],e[8]=u*o[2*4+0],e[9]=u*o[2*4+1],e[10]=u*o[2*4+2],e[11]=u*o[2*4+3],o!==e&&(e[12]=o[12],e[13]=o[13],e[14]=o[14],e[15]=o[15]),e}function d1(o,n){return n=n||new g(16),n[0]=o,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=o,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=o,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function no(o,n,e){return e=e||new g(16),e[0]=n*o[0*4+0],e[1]=n*o[0*4+1],e[2]=n*o[0*4+2],e[3]=n*o[0*4+3],e[4]=n*o[1*4+0],e[5]=n*o[1*4+1],e[6]=n*o[1*4+2],e[7]=n*o[1*4+3],e[8]=n*o[2*4+0],e[9]=n*o[2*4+1],e[10]=n*o[2*4+2],e[11]=n*o[2*4+3],o!==e&&(e[12]=o[12],e[13]=o[13],e[14]=o[14],e[15]=o[15]),e}var k=Object.freeze({__proto__:null,aim:D1,axisRotate:Bn,axisRotation:_n,cameraAim:N1,clone:z1,copy:un,create:A1,determinant:P1,equals:q1,equalsApproximately:C1,fromMat3:g1,fromQuat:T1,frustum:O1,getAxis:V1,getScaling:G1,getTranslation:R1,identity:qn,inverse:vn,invert:_1,lookAt:Y1,mul:B1,multiply:Pn,negate:E1,ortho:L1,perspective:I1,rotate:m1,rotateX:Q1,rotateY:Z1,rotateZ:J1,rotation:K1,rotationX:k1,rotationY:W1,rotationZ:H1,scale:s1,scaling:b1,set:S1,setAxis:U1,setDefaultType:y1,setTranslation:F1,translate:j1,translation:X1,transpose:v1,uniformScale:no,uniformScaling:d1}),oo="struct Transform{matrix: mat4x4f};struct VertexOutput{@builtin(position)position: vec4f,@location(0)textureCoord: vec2f};@group(0)@binding(0)var Sampler: sampler;@group(0)@binding(1)var Texture: texture_2d<f32>;@group(0)@binding(2)var<uniform>transform: Transform;@vertex fn vertex(@builtin(vertex_index)index: u32)->VertexOutput {var output: VertexOutput;var position=GetQuadCoord(index);position=(position+1)*0.5;output.position=transform.matrix*vec4f(position,0.0,1.0);output.textureCoord=position*vec2f(1,50);return output;}@fragment fn fragment(@location(0)textureCoord: vec2f)->@location(0)vec4f {return textureSample(Texture,Sampler,textureCoord);}";/**
 * @module Mipmap Filter
 * @author Ustym Ukhman <ustym.ukhman@gmail.com>
 * @description This lesson is reproduced from WebGPU Textures
 * {@link https://webgpufundamentals.org/webgpu/lessons/webgpu-textures.html#mipmapfilter}&nbsp;
 * and developed by using a version listed below. Please note that this code
 * may be simplified in future thanks to more recent library APIs.
 * @version 0.0.5
 * @license MIT
 */(async function(o){let n;try{n=new(await pn.RenderPipeline(o,"Mipmap Filter"))}catch(x){alert(x)}const e=n.CreatePassDescriptor(n.CreateColorAttachment(void 0,"clear","store",new Vn(5000268).rgba)),c=n.CreateShaderModule([Un,oo]),r=new(await pn.Texture());n.CreatePipeline({vertex:n.CreateVertexState(c),fragment:n.CreateFragmentState(c)});let u=0;const i=0,l=[],p=[B(Fn(),"Blended"),B(Rn(),"Checked")];for(let x=0;x<8;x++){const v=r.CreateSampler({addressModeU:Mn.REPEAT,addressModeV:Mn.REPEAT,magFilter:x&1?W.LINEAR:W.NEAREST,minFilter:x&2?W.LINEAR:W.NEAREST,mipmapFilter:x&4?W.LINEAR:W.NEAREST}),q=16*Float32Array.BYTES_PER_ELEMENT,z=n.CreateBuffer({usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST,size:q}),_=new Float32Array(q/Float32Array.BYTES_PER_ELEMENT),R=_.subarray(i,16);n.AddBindGroups(p.map(V=>n.CreateBindGroup(n.CreateBindGroupEntries([v,V.createView(),{buffer:z}])))),l.push({matrixBuffer:z,matrixValues:_,matrix:R})}const h=1,M=2e3,f=[0,1,0],t=[0,0,0],$=60*Math.PI/180,w=[0,0,2],y=x1.set(1.2,.7),a=k.perspective($,n.AspectRatio,h,M),S=k.inverse(k.lookAt(w,t,f)),A=k.multiply(a,S);function B(x,v){const q=r.CreateTexture({usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST,size:[x[0].width,x[0].height],mipLevelCount:x.length,label:`${v} Texture`,format:"rgba8unorm"});return x.forEach(({data:z,width:_,height:R},V)=>r.WriteTexture(z,{bytesPerRow:_*4,texture:q,mipLevel:V,width:_,height:R})),q}function F(){e.colorAttachments[0].view=n.CurrentTextureView,l.forEach(({matrix:x,matrixBuffer:v,matrixValues:q},z)=>{const R=z%4-1.5,V=+(z<4)*2-1,I=[R*y[0],V*y[1],-50*.5];k.translate(A,I,x),k.rotateX(x,.5*Math.PI,x),k.scale(x,[1,50*2,1],x),k.translate(x,[-.5,-.5,0],x),n.SetActiveBindGroups(z*2+u),n.WriteBuffer(v,q),n.Render(6,!1)}),n.Submit()}new ResizeObserver(x=>{for(const v of x){const{inlineSize:q,blockSize:z}=v.contentBoxSize[0];n.SetCanvasSize(q,z)}k.perspective($,n.AspectRatio,h,M,a),k.multiply(a,S,A),F()}).observe(o),o.addEventListener("click",()=>{u=(u+1)%p.length,F()})})(document.getElementById("lesson"));
