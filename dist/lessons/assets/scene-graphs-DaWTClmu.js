import{_ as e,a as t,c as n,d as r,g as i,i as a,l as o,n as s,s as c,u as ee}from"./lib-1rS3DT50.js";import{addButtonLeftJustified as te}from"https://webgpufundamentals.org/webgpu/resources/js/gui-helpers.js";var l=`struct VertexInput{@location(0)position: vec4f,@location(1)color: vec4f};struct VertexOutput{@location(0)color: vec4f,@builtin(position)position: vec4f};@vertex fn cubeVertex(input: VertexInput)->VertexOutput {return VertexOutput(input.color,GetVertexClipSpace(input.position));}@fragment fn cubeFragment(vertex: VertexOutput)->@location(0)vec4f {return vertex.color*color;}`;(async function(u){let d;u.style.backgroundColor=`#000`;try{d=new(await(i.Renderer(u,`Scene Graphs`)))}catch(e){alert(e)}let f={min:-90,max:90,step:1,converters:GUI.converters.radToDeg},ne={min:-180,max:180,step:1,converters:GUI.converters.radToDeg},p=new ee(16777215),m=new o(16777215),h=new o(p.Set(8355711)),re=new o(p.Set(12566463,191)),[g,_,v]=[0,1,2],ie=new Set([0,1,2]),y=[40,30,50],b=[10,2,2],x=[],S=!1,C,w,T,E=0,D={cameraRotation:r.DegreesToRadians(-45),animate:!1,showMeshNodes:!1,showAllTransforms:!1,position:r.Vec3.create(),rotation:r.Vec3.create(),scale:r.Vec3.set(1,1,1)},O=new t,k=new GUI().onChange($);k.add(D,`cameraRotation`,ne).onChange(K),k.add(D,`animate`).onChange(e=>A.enable(!e)),k.add(D,`showMeshNodes`).onChange(Z),k.add(D,`showAllTransforms`).onChange(X);let A=k.addFolder(`Orientation`);A.onChange(()=>T.Transform=[D.position,D.rotation,D.scale]);let j=[A.add(D.position,`0`,-200,200,1).name(`Position X`),A.add(D.position,`1`,-200,200,1).name(`Position Y`),A.add(D.position,`2`,-200,200,1).name(`Position Z`),A.add(D.rotation,`0`,f).name(`Rotation X`),A.add(D.rotation,`1`,f).name(`Rotation Y`),A.add(D.rotation,`2`,f).name(`Rotation Z`),A.add(D.scale,`0`,.1,100).name(`Scale X`),A.add(D.scale,`1`,.1,100).name(`Scale Y`),A.add(D.scale,`2`,.1,100).name(`Scale Z`)],M=[0,y[_]/3*2-y[_]/2,b[v]/2+y[v]/2],N=y[g]+10,P=y[_]+3,F=[y[g]+6,P*4+6,y[v]+4],I=new c(`Cube`,`uint16`);I.Primitive=n();let L=new d.Pipeline,R=new s,z=F[g]+N,B={name:`color`,format:`unorm8x4`},V=z/2*4/2+4,H=L.CreateShaderModule([e,l]);await d.AddPipeline(L,{primitive:L.CreatePrimitiveState(),depthStencil:L.CreateDepthStencilState(),fragment:L.CreateFragmentState(H,void 0,`cubeFragment`),vertex:L.CreateVertexState(H,[I.GetPositionBufferLayout(L),L.CreateVertexBufferLayout(B,`cubeVertex`)],`cubeVertex`)});let U=J(B);Array.from({length:5}).forEach((e,t)=>oe(O,t));let W=G(k.addFolder(`Nodes`),O);Y(O.Children[0]),X(!1),Z(!1);function G(e,t,n,r){let i=[],a=r===void 0;if(t.Label!==`Scene`){let n=`${a?``:`${r}\u00a0+-`}${t.Label}`;i.push(te(e,n,()=>Y(t)))}return r=a?``:`${r}${n?`\xA0\xA0\xA0`:`\xA0|\xA0`}`,i.push(...t.Children.map((n,i)=>G(e,n,i===t.Children.length-1,r))),i.flat()}function K(e){R.Transform=[[V,20,0],[0,e,0]],R.Position=[0,0,300],R.UpdateViewProjectionMatrix()}function q(){let{Position:e,Rotation:t,Scaling:n}=T;D.position.set(e),D.rotation.set(t),D.scale.set(n),A.updateDisplay()}function J(e){let t=new Uint8Array(96),n=[70,200,210,160,160,220,200,70,120,80,70,200,200,200,70,90,130,110];for(let e=0,r=0;e<24;r=(++e/4|0)*3)t.set(n.slice(r,r+3),e*4),t[e*4+3]=255;let{buffer:r}=L.CreateVertexBuffer(e,24,`cubeVertex`);return L.WriteBuffer(r,t),r}function Y(e){T=e,A.name(`Orientation: ${e.Label}`),q()}function X(e){j.forEach((t,n)=>t.show(e||ie.has(n)))}function Z(e){for(let t of W)t.domElement.textContent.includes(`mesh`)&&t.show(e)}function Q(e,t,n,r){let i=new a(I,r,e,t);return i.SetRenderPipeline(L),L.AddVertexBuffers(U),i.Transform=n,i}function ae(e,t){let n=`drawer${t}`,r=F[_]/2-y[_]/2-5,i=Q(n,e,[[0,P*t-r,3]]);x.push(i),Q(`${n}-drawer-mesh`,i,[void 0,void 0,y],m),Q(`${n}-handle-mesh`,i,[M,void 0,b],h)}function oe(e,t){let n=`cabinet${t}`,r=Q(n,e,[[t*N,0,0]]);Q(`${n}-mesh`,r,[void 0,void 0,F],re);for(let e=0;e<4;++e)ae(r,e)}function $(){C||=requestAnimationFrame(ce)}function se(){x.forEach((e,t)=>e.Position[2]=r.Lerp(3,y[2]*.8,Math.sin(E+t)*.5+.5))}function ce(){C=void 0,d.Render(O);let e=D.animate,t=performance.now()*.001,n=S&&t-w||0;w=t,S=e,e&&(E+=n),D.animate&&(se(),q(),$())}new ResizeObserver(e=>{for(let t of e){let{inlineSize:e,blockSize:n}=t.contentBoxSize[0];d.SetCanvasSize(e,n),R.AspectRatio=d.AspectRatio,K(D.cameraRotation),O.AddCamera(R)}$()}).observe(document.body)})(document.getElementById(`lesson`));