import{a as e,c as t,d as n,f as r,i,n as a,u as o}from"./lib-BpSa0Z_M.js";import{t as s}from"./F-WmVUQw7f.js";var c=`struct Uniforms{color: vec4f,light: vec3f,camera: vec3f,world: mat4x4f,normal: mat3x3f,intensity: f32};struct VertexOutput{@location(0)normal: vec3f,@location(1)lightVector: vec3f,@location(2)cameraVector: vec3f,@builtin(position)position: vec4f};@group(0)@binding(1)var<uniform>uniforms: Uniforms;@group(0)@binding(0)var<uniform>meshModelViewProjection: mat4x4f;@vertex fn vertex(@location(0)position: vec4f,@location(1)normal: vec3f)->VertexOutput {var output: VertexOutput;let worldPosition=(uniforms.world*position).xyz;output.lightVector=uniforms.light-worldPosition;output.cameraVector=uniforms.camera-worldPosition;output.position=meshModelViewProjection*position;output.normal=uniforms.normal*normal;return output;}@fragment fn fragment(vertex: VertexOutput)->@location(0)vec4f {let lightDirection=normalize(vertex.lightVector);let normal=normalize(vertex.normal);let light=dot(normal,lightDirection);let cameraDirection=normalize(vertex.cameraVector);var specular=dot(normal,normalize(lightDirection+cameraDirection));specular=pow(max(0,specular),uniforms.intensity);let color=uniforms.color.rgb*light+specular;return vec4f(color,uniforms.color.a);}`;(async function(l){let u;try{u=new(await(r.Renderer(l,`Point Lighting`)))}catch(e){alert(e)}let d=new e,f=new GUI;f.onChange(D);let p=new a,m=new t,h=new i(m,null),g=new u.Pipeline;u.CreatePassDescriptor(u.CreateColorAttachment(),u.CreateDepthStencilAttachment());let _=g.CreateShaderModule(c),{uniforms:v,buffer:y}=g.CreateUniformBuffer(`uniforms`),b={rotation:n.DegreesToRadians(0),shininess:30},x={min:-360,max:360,step:1,converters:GUI.converters.radToDeg},S=[g.CreateVertexBufferLayout({name:`position`,format:`float32x3`}),g.CreateVertexBufferLayout({name:`normal`,format:`float32x3`})],{vertexData:C,normalData:w,vertices:T}=s(),E=g.CreateVertexBuffer(w);h.SetRenderPipeline(await u.AddPipeline(g,{vertex:g.CreateVertexState(_,S),depthStencil:g.CreateDepthStencilState(),fragment:g.CreateFragmentState(_),primitive:g.CreatePrimitiveState()}),y),f.add(b,`rotation`,x),f.add(b,`shininess`,{min:1,max:250}),m.CreateVertexBuffer(g,C),g.WriteBuffer(E,w),g.AddVertexBuffers(E),m.SetDrawParams(T),v.color.set(new o(3407667).rgba),v.light.set([-10,30,100]),d.Add(h);function D(){v.camera.set(p.Position),v.intensity[0]=b.shininess;let e=n.Mat4.rotationY(b.rotation,v.world);n.Mat3.fromMat4(n.Mat4.transpose(n.Mat4.inverse(e)),v.normal),g.WriteBuffer(y,v.normal.buffer),h.Rotation=[0,b.rotation,0],u.Render(d)}new ResizeObserver(e=>{for(let t of e){let{inlineSize:e,blockSize:n}=t.contentBoxSize[0];u.SetCanvasSize(e,n),p.AspectRatio=u.AspectRatio,p.UpdateViewProjectionMatrix(),p.Position=[100,150,200],p.LookAt([0,35,0]),d.AddCamera(p)}D()}).observe(document.body)})(document.getElementById(`lesson`));